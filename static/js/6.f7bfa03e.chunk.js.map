{"version":3,"sources":["components/Timetable.js","components/LegendDep.js","pages/VBBDepartures.js"],"names":["Timetable","props","_useState","useState","stops","allStops","Object","slicedToArray","_useState3","_useState4","selection","setSelection","_useState5","_useState6","stop","setStop","_useState7","_useState8","data","setData","_useState9","_useState10","viewData","setViewData","_useState11","_useState12","error","setError","useEffect","initialStopArray","filter","name","initialStop","initialId","id","getData","remainingStops","stopSelection","concat","toConsumableArray","inputField","useRef","filterField","filterSelector","filterOr","filterValues","filteredData","departure","decider","i","length","line","toLowerCase","includes","direction","filterAnd","noFilters","_ref","asyncToGenerator","regenerator_default","a","mark","_callee","currentStopArray","_currentStopArray","currentStop","_currentStop$type","type","duration","url","response","_yield$response","resData","status","wrap","_context","prev","next","getDuration","axios","get","sent","_x","apply","this","arguments","react_default","createElement","className","Input","filterStops","event","filterValue","currStop","newSelection","target","value","Select","handleChange","myStopId","current","Button","handleSubmit","Filter","filterData","split","filterMode","StopBody","LegendDep","getLocale","Legendrow","left","right","App","Timetable_Timetable"],"mappings":"uPAYe,SAASA,EAAUC,GAAO,IAAAC,EACpBC,mBAASC,KAArBC,EADgCC,OAAAC,EAAA,EAAAD,CAAAJ,EAAA,MAAAM,EAELL,mBAASC,KAFJK,EAAAH,OAAAC,EAAA,EAAAD,CAAAE,EAAA,GAEhCE,EAFgCD,EAAA,GAErBE,EAFqBF,EAAA,GAAAG,EAGfT,mBAAS,IAHMU,EAAAP,OAAAC,EAAA,EAAAD,CAAAM,EAAA,GAGhCE,EAHgCD,EAAA,GAG1BE,EAH0BF,EAAA,GAAAG,EAIfb,mBAAS,IAJMc,EAAAX,OAAAC,EAAA,EAAAD,CAAAU,EAAA,GAIhCE,EAJgCD,EAAA,GAI1BE,EAJ0BF,EAAA,GAAAG,EAKPjB,mBAAS,IALFkB,EAAAf,OAAAC,EAAA,EAAAD,CAAAc,EAAA,GAKhCE,EALgCD,EAAA,GAKtBE,EALsBF,EAAA,GAAAG,EAMbrB,mBAAS,MANIsB,EAAAnB,OAAAC,EAAA,EAAAD,CAAAkB,EAAA,GAMhCE,EANgCD,EAAA,GAMzBE,EANyBF,EAAA,GAOvCG,oBAAU,WACR,IAAMC,EAAmBzB,IAAM0B,OAC7B,SAAChB,GAAD,MAAwB,iBAAdA,EAAKiB,OAEVC,EAJO1B,OAAAC,EAAA,EAAAD,CAIQuB,EAJR,MAKFI,EAAcD,EAAlBE,GACRnB,EAAQiB,GACRG,EAAQF,GACR,IAAMG,EAAiB/B,EAASyB,OAC9B,SAAChB,GAAD,OAAUA,EAAKiB,OAASC,EAAYD,OAEhCM,EAAa,CAAIL,GAAJM,OAAAhC,OAAAiC,EAAA,EAAAjC,CAAoB8B,IACvCzB,EAAa0B,IACZ,IACH,IAAMG,EAAaC,iBAAO,MACpBC,EAAcD,iBAAO,MACrBE,EAAiBF,iBAAO,MAiBxBG,EAAW,SAACC,GAChB,IAAMC,EAAe5B,EAAKY,OAAO,SAACiB,GAEhC,IADA,IAAIC,GAAU,EACLC,EAAI,EAAGA,EAAIJ,EAAaK,OAAQD,IACvC,GACEF,EAAUI,KAAKpB,KACZqB,cACAC,SAASR,EAAaI,GAAGG,gBAC5BL,EAAUO,UACPF,cACAC,SAASR,EAAaI,GAAGG,eAC5B,CACAJ,GAAU,EACV,MAGJ,OAAOA,IAETzB,EAAYuB,IAERS,EAAY,SAACV,GACjB,IAAMC,EAAe5B,EAAKY,OAAO,SAACiB,GAEhC,IADA,IAAIC,GAAU,EACLC,EAAI,EAAGA,EAAIJ,EAAaK,OAAQD,IACvC,IACEF,EAAUI,KAAKpB,KACZqB,cACAC,SAASR,EAAaI,GAAGG,iBAC5BL,EAAUO,UACPF,cACAC,SAASR,EAAaI,GAAGG,eAN9B,CAUEJ,GAAU,EACV,MAGJ,OAAOA,IAETzB,EAAYuB,IAERU,EAAY,WAChBjC,EAAYL,IAoBRiB,EAAO,eAAAsB,EAAAnD,OAAAoD,EAAA,EAAApD,CAAAqD,EAAAC,EAAAC,KAAG,SAAAC,EAAO5B,GAAP,IAAA6B,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OAAAd,EAAAC,EAAAc,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cACRd,EAAmB1D,EAASyB,OAAO,SAAChB,GAAD,OAAUA,EAAKoB,KAAOA,IADjD8B,EAAA1D,OAAAC,EAAA,EAAAD,CAEQyD,EAFR,GAEPE,EAFOD,EAAA,GAAAE,EAGWD,EAAjBE,YAHM,IAAAD,EAGC,MAHDA,EAIRE,EAAWU,YAAYX,GACvBE,EALQ,+CAAA/B,OAK6CJ,EAL7C,cAAAI,OAK4D8B,GAL5DO,EAAAE,KAAA,EAMSE,IAAMC,IAAIX,GANnB,cAMRC,EANQK,EAAAM,KAAAN,EAAAE,KAAA,GAO0BP,EAP1B,QAAAC,EAAAI,EAAAM,KAOAT,EAPAD,EAONrD,KACO,OADQuD,EAPTF,EAOSE,SACU,MAAXA,GACpB9C,EAAQ,qBAAAW,OAAsBmC,IAC9BtD,EAAQ,MAERA,EAAQqD,GACRjD,EAAYiD,GACZ7C,EAAS,OAdG,yBAAAgD,EAAA7D,SAAAgD,MAAH,gBAAAoB,GAAA,OAAAzB,EAAA0B,MAAAC,KAAAC,YAAA,GAkCb,OACEC,EAAA1B,EAAA2B,cAAA,OAAKC,UAAU,aACbF,EAAA1B,EAAA2B,cAACE,EAAA,EAAD,CAAOC,YA7CM,SAACC,IATE,SAACC,GACnB,IAAMxD,EAAiB/B,EAASyB,OAC9B,SAAC+D,GAAD,OACEA,EAAS3D,KAAOpB,EAAKoB,IACrB2D,EAAS9D,KAAKqB,cAAcC,SAASuC,EAAYxC,iBAE/C0C,EAAY,CAAIhF,GAAJwB,OAAAhC,OAAAiC,EAAA,EAAAjC,CAAa8B,IAC/BzB,EAAamF,GAKbJ,CADoBC,EAAMI,OAAOC,QA2CDxD,WAAYA,IAC1C8C,EAAA1B,EAAA2B,cAACU,EAAA,EAAD,CAAQC,aApBS,SAACjC,GAnBpBlD,EAoBYkD,GADwB,IAExBkC,EAAalC,EAAjB/B,GACRC,EAAQgE,GACR3D,EAAW4D,QAAQJ,MAAQ,GAC3BtD,EAAY0D,QAAQJ,MAAQ,GAC5BrD,EAAeyD,QAAQJ,MAAQ,MAcOtF,UAAWA,EAAWI,KAAMA,IAChEwE,EAAA1B,EAAA2B,cAACc,EAAA,EAAD,CAAQC,aAbS,WACnBnE,EAAQrB,EAAKoB,IACbM,EAAW4D,QAAQJ,MAAQ,GAC3BtD,EAAY0D,QAAQJ,MAAQ,GAC5BrD,EAAeyD,QAAQJ,MAAQ,QAU7BV,EAAA1B,EAAA2B,cAACgB,EAAA,EAAD,CACE7D,YAAaA,EACbC,eAAgBA,EAChB6D,WAzHa,SAACb,GAAU,IAGtB9C,EAF4BH,EAA1B0D,QACAJ,MACwBS,MAAM,KAEvBC,EADsB/D,EAA7ByD,QACAJ,MACJnD,EAAaK,OAAS,EACL,OAAfwD,EACF9D,EAASC,GAETU,EAAUV,GAGZW,OA8GA8B,EAAA1B,EAAA2B,cAACoB,EAAA,EAAD,CAAU7F,KAAMA,EAAMI,KAAMI,EAAUI,MAAOA,8BC1JpC,SAASkF,IACtB,OACEtB,EAAA1B,EAAA2B,cAAA,OAAKC,UAAU,UACbF,EAAA1B,EAAA2B,cAAA,MAAIC,UAAU,UAAUqB,YAAU,WAClCvB,EAAA1B,EAAA2B,cAACuB,EAAA,EAAD,CACEC,KAAMF,YAAU,aAChBG,MAAOH,YAAU,mBAEnBvB,EAAA1B,EAAA2B,cAACuB,EAAA,EAAD,CACEC,KAAMF,YAAU,QAChBG,MAAOH,YAAU,cAEnBvB,EAAA1B,EAAA2B,cAACuB,EAAA,EAAD,CAAWC,KAAMF,YAAU,SAAUG,MAAOH,YAAU,eACtDvB,EAAA1B,EAAA2B,cAACuB,EAAA,EAAD,CAAWC,KAAMF,YAAU,QAASG,MAAOH,YAAU,cACrDvB,EAAA1B,EAAA2B,cAACuB,EAAA,EAAD,CAAWC,KAAMF,YAAU,aAAcG,MAAOH,YAAU,mBAC1DvB,EAAA1B,EAAA2B,cAACuB,EAAA,EAAD,CACEC,KAAMzB,EAAA1B,EAAA2B,cAAA,QAAMC,UAAU,sBACtBwB,MAAOH,YAAU,iBAEnBvB,EAAA1B,EAAA2B,cAACuB,EAAA,EAAD,CACEC,KAAMzB,EAAA1B,EAAA2B,cAAA,QAAMC,UAAU,mBACtBwB,MAAOH,YAAU,UAEnBvB,EAAA1B,EAAA2B,cAACuB,EAAA,EAAD,CACEC,KAAMzB,EAAA1B,EAAA2B,cAAA,QAAMC,UAAU,gCACtBwB,MAAOH,YAAU,eAEnBvB,EAAA1B,EAAA2B,cAACuB,EAAA,EAAD,CACEC,KAAMzB,EAAA1B,EAAA2B,cAAA,QAAMC,UAAU,iBACtBwB,MAAOH,YAAU,gBCpBVI,UATf,WACE,OACE3B,EAAA1B,EAAA2B,cAAA,WACED,EAAA1B,EAAA2B,cAACqB,EAAD,MACAtB,EAAA1B,EAAA2B,cAAC2B,EAAD","file":"static/js/6.f7bfa03e.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\"\nimport axios from \"axios\"\nimport \"../styles/Timetable.scss\"\nimport Input from \"./Input\"\nimport Select from \"./Select\"\nimport Button from \"./Button\"\nimport StopBody from \"./StopBody\"\nimport Filter from \"./Filter\"\nimport stops from \"../data/stops\"\nimport { getDuration } from \"../components/helpers\"\n/* eslint-disable react-hooks/exhaustive-deps */\n\nexport default function Timetable(props) {\n  const [allStops] = useState(stops)\n  const [selection, setSelection] = useState(stops)\n  const [stop, setStop] = useState({})\n  const [data, setData] = useState([])\n  const [viewData, setViewData] = useState([])\n  const [error, setError] = useState(null)\n  useEffect(() => {\n    const initialStopArray = stops.filter(\n      (stop) => stop.name === \"U Stadtmitte\"\n    )\n    const [initialStop] = initialStopArray\n    const { id: initialId } = initialStop\n    setStop(initialStop)\n    getData(initialId)\n    const remainingStops = allStops.filter(\n      (stop) => stop.name !== initialStop.name\n    )\n    const stopSelection = [initialStop, ...remainingStops]\n    setSelection(stopSelection)\n  }, []) \n  const inputField = useRef(null)\n  const filterField = useRef(null)\n  const filterSelector = useRef(null)\n  const filterData = (event) => {\n    const { current: fieldCurrent } = filterField\n    const { value: fieldValue } = fieldCurrent\n    const filterValues = fieldValue.split(\" \")\n    const { current: selectorCurrent } = filterSelector\n    const { value: filterMode } = selectorCurrent\n    if (filterValues.length > 0) {\n      if (filterMode === \"OR\") {\n        filterOr(filterValues)\n      } else {\n        filterAnd(filterValues)\n      }\n    } else {\n      noFilters()\n    }\n  }\n  const filterOr = (filterValues) => {\n    const filteredData = data.filter((departure) => {\n      let decider = false\n      for (let i = 0; i < filterValues.length; i++) {\n        if (\n          departure.line.name\n            .toLowerCase()\n            .includes(filterValues[i].toLowerCase()) ||\n          departure.direction\n            .toLowerCase()\n            .includes(filterValues[i].toLowerCase())\n        ) {\n          decider = true\n          break\n        }\n      }\n      return decider\n    })\n    setViewData(filteredData)\n  }\n  const filterAnd = (filterValues) => {\n    const filteredData = data.filter((departure) => {\n      let decider = true\n      for (let i = 0; i < filterValues.length; i++) {\n        if (\n          departure.line.name\n            .toLowerCase()\n            .includes(filterValues[i].toLowerCase()) ||\n          departure.direction\n            .toLowerCase()\n            .includes(filterValues[i].toLowerCase())\n        ) {\n          continue\n        } else {\n          decider = false\n          break\n        }\n      }\n      return decider\n    })\n    setViewData(filteredData)\n  }\n  const noFilters = () => {\n    setViewData(data)\n  }\n  const filterStops = (filterValue) => {\n    const remainingStops = allStops.filter(\n      (currStop) =>\n        currStop.id !== stop.id &&\n        currStop.name.toLowerCase().includes(filterValue.toLowerCase())\n    )\n    const newSelection = [stop, ...remainingStops]\n    setSelection(newSelection)\n  }\n  const doFilter = (event) => {\n    // if (event.key === \"Enter\") {\n    const filterValue = event.target.value\n    filterStops(filterValue)\n    // }\n  }\n  const setCurrStop = (currStop) => {\n    setStop(currStop)\n  }\n  const getData = async (id) => {\n    const currentStopArray = allStops.filter((stop) => stop.id === id)\n    const [currentStop] = currentStopArray\n    const { type = \"BBG\" } = currentStop\n    const duration = getDuration(type)\n    const url = `https://sklinkusch-vbbmicro.now.sh/?station=${id}&duration=${duration}`\n    const response = await axios.get(url)\n    const { data: resData, status } = await response\n    if (status === 500 || status !== 200) {\n      setError(`HTTP status code: ${status}`)\n      setData([])\n    } else {\n      setData(resData)\n      setViewData(resData)\n      setError(null)\n    }\n  }\n  const handleChange = (currentStop) => {\n    setCurrStop(currentStop)\n    const { id: myStopId } = currentStop\n    getData(myStopId)\n    inputField.current.value = \"\"\n    filterField.current.value = \"\"\n    filterSelector.current.value = \"OR\"\n  }\n  const handleSubmit = () => {\n    getData(stop.id)\n    inputField.current.value = \"\"\n    filterField.current.value = \"\"\n    filterSelector.current.value = \"OR\"\n  }\n  // useEffect(() => {\n  //   getData(stop);\n  // }, []);\n  return (\n    <div className=\"timetable\">\n      <Input filterStops={doFilter} inputField={inputField} />\n      <Select handleChange={handleChange} selection={selection} stop={stop} />\n      <Button handleSubmit={handleSubmit} />\n      <Filter\n        filterField={filterField}\n        filterSelector={filterSelector}\n        filterData={filterData}\n      />\n      <StopBody stop={stop} data={viewData} error={error} />\n    </div>\n  )\n}\n","import React from \"react\";\nimport Legendrow from \"./Legendrow\";\nimport getLocale from \"./getLocale\";\nimport \"../styles/Legend.scss\";\n\nexport default function LegendDep() {\n  return (\n    <div className=\"legend\">\n      <h3 className=\"col-24\">{getLocale(\"legend\")}</h3>\n      <Legendrow\n        left={getLocale(\"scheduled\")}\n        right={getLocale(\"scheduledDesc\")}\n      />\n      <Legendrow\n        left={getLocale(\"real\")}\n        right={getLocale(\"realDesc\")}\n      />\n      <Legendrow left={getLocale(\"delay\")} right={getLocale(\"delayDesc\")} />\n      <Legendrow left={getLocale(\"line\")} right={getLocale(\"lineDesc\")} />\n      <Legendrow left={getLocale(\"direction\")} right={getLocale(\"directionDesc\")} />\n      <Legendrow\n        left={<span className=\"fas fa-wheelchair\" />}\n        right={getLocale(\"barrierfree\")}\n      />\n      <Legendrow\n        left={<span className=\"fas fa-bicycle\" />}\n        right={getLocale(\"bike\")}\n      />\n      <Legendrow\n        left={<span className=\"fas fa-exclamation-triangle\" />}\n        right={getLocale(\"attention\")}\n      />\n      <Legendrow\n        left={<span className=\"fas fa-times\" />}\n        right={getLocale(\"cancelled\")}\n      />\n    </div>\n  );\n}\n","import React from \"react\"\nimport \"../styles/App.scss\"\nimport Timetable from \"../components/Timetable\"\nimport LegendDep from \"../components/LegendDep\"\n\nfunction App() {\n  return (\n    <div>\n      <LegendDep />\n      <Timetable />\n    </div>\n  )\n}\n\nexport default App\n"],"sourceRoot":""}