"use strict";(self.webpackChunkvbb=self.webpackChunkvbb||[]).push([[985],{2985:(t,e,n)=>{n.r(e),n.d(e,{default:()=>m});var i=n(2791),a=n(7689),o=n(5918),r=n(2530),c=n(4307),s=n(6313),l=n(3090),d=n(953),u=n(1036),g=n(1029),p=n(4994),h=n(9922);function m(){const[t,e]=(0,o.Rh)("selection",[]),[n,m]=(0,o.Rh)("filterSelection",[]),[f,y]=(0,o.Rh)("stop",{id:"",name:"",type:""}),[b,v]=(0,o.Rh)("filterStop",{id:"0",name:"\u2e3a",type:""}),[w,S]=(0,o.Rh)("data",[]),[Z,R]=(0,o.Rh)("date",""),[B,D]=(0,o.Rh)("error",null),[E,k]=(0,o.Rh)("express",!0),[A,L]=(0,o.Rh)("regional",!0),[O,T]=(0,o.Rh)("suburban",!0),[j,W]=(0,o.Rh)("subway",!0),[x,z]=(0,o.Rh)("tram",!0),[C,I]=(0,o.Rh)("bus",!0),[P,q]=(0,o.Rh)("ferry",!0),[F,N]=(0,o.Rh)("time",(new Date).toLocaleString("sv",{timeZone:"Europe/Berlin",minute:"2-digit",hour:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}).replace(" ","T")),X=(0,a.UO)(),G=(0,a.s0)();(0,i.useEffect)((()=>{!async function(){if(X.hasOwnProperty("id")&&"string"===typeof X.id&&9===X.id.length)try{const t="https://vbb-rest.vercel.app/stops/".concat(X.id,"?language=de"),n=await fetch(t),i=await n.json(),{name:a}=await i;G("/arrivals/".concat(X.id)),y(i),J(X.id,a,{direction:"0"}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(a):"Arrivals at ".concat(a);e([i])}catch(B){console.debug(B)}else if(X.hasOwnProperty("id")&&"string"===typeof X.id&&12===X.id.length)try{const t="".concat(X.id.slice(0,1)).concat(X.id.slice(-8)),n="https://vbb-rest.vercel.app/stops/".concat(t,"?language=de"),i=await fetch(n),a=await i.json(),{name:o}=await a;G("/arrivals/".concat(t)),y(a),J(t,o,{direction:"0"}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(o):"Arrivals at ".concat(o);e([a])}catch(B){console.debug(B)}else try{const t="900100011",n="https://vbb-rest.vercel.app/stops/".concat(t,"?language=de"),i=await fetch(n),a=await i.json(),{name:o}=await a;G("/arrivals/".concat(t)),y(a),J(t,o,{direction:"0"}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(o):"Arrivals at ".concat(o);e([a])}catch(B){console.debug(B)}}()}),[]);const H=(0,i.useRef)(null),U=(0,i.useRef)(null),J=async(t,e,n)=>{try{const i=e.startsWith("Berlin")?"BLN":"BBG",a=(0,r.g)(i);let o="de";o=navigator.language.startsWith("de")?"de":"en";const c=n.direction?"0"!==n.direction?parseInt(n.direction,10):null:"0"!==b.id?parseInt(b.id,10):null,s="number"===typeof c?"&direction=".concat(c):"";if((t===f.id||""===Z)&&!n.time){const t=(new Date).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}),e=(new Date).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T");R(t),N(e)}const l="https://vbb-rest.vercel.app/stops/".concat(t,"/arrivals?language=").concat(o,"&duration=").concat(a,"&express=").concat("boolean"===typeof n.express?n.express.toString():E.toString(),"&regional=").concat("boolean"===typeof n.regional?n.regional.toString():A.toString(),"&suburban=").concat("boolean"===typeof n.suburban?n.suburban.toString():O.toString(),"&subway=").concat("boolean"===typeof n.subway?n.subway.toString():j.toString(),"&tram=").concat("boolean"===typeof n.tram?n.tram.toString():x.toString(),"&bus=").concat("boolean"===typeof n.bus?n.bus.toString():C.toString(),"&ferry=").concat("boolean"===typeof n.ferry?n.ferry.toString():P.toString()).concat(s,"&when=").concat("string"===typeof n.time?new Date(n.time).toISOString():new Date(F).toISOString()),d=await fetch(l),{status:u}=await d,g=await d.json();if(500===u||200!==u)D("HTTP status code: ".concat(u)),S([]);else{const{arrivals:t}=g;document.title="de"===o?"Ank\xfcnfte an ".concat(e):"Arrivals at ".concat(e),S(t),D(null)}}catch(B){console.debug(B)}};return(0,h.BX)("div",{className:"timetable",children:[(0,h.tZ)(c.Z,{filterStops:async t=>{const n=t.target.value;try{if(n.length>4){const t="https://vbb-rest.vercel.app/locations?query=".concat(n,"&results=15&fuzzy=true&stops=true&addresses=false&poi=false&language=de&linesOfStops=true"),i=await fetch(t),a=await i.json(),o=[f,...a];e(o)}else e([f])}catch(B){console.debug(B)}},inputField:H}),(0,h.tZ)(s.Z,{handleChange:t=>{y(t);const{id:e,name:n}=t;J(e,n,{direction:"0"});H.current.value=""},selection:t,stop:f,mode:"arr"}),(0,h.tZ)(l.Z,{handleSubmit:()=>{const t=(new Date).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}),e=(new Date).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T");R(t),N(e),J(f.id,f.name,{time:e});H.current.value=""}}),(0,h.BX)("div",{children:[(0,h.tZ)("span",{sx:{display:"inline-block",mr:"0.2rem",fontStyle:"italic",fontWeight:700},children:"via"}),(0,h.tZ)(c.Z,{filterStops:async t=>{const e=t.target.value;try{const t={id:"0",name:"\u2e3a",type:""};if(e.length>=3){const n="https://vbb-rest.vercel.app/locations?query=".concat(e,"&results=15&fuzzy=true&stops=true&addresses=false&poi=false&language=de&linesOfStops=true"),i=await fetch(n),a=await i.json(),o="0"!==b.id?[t,b,...a]:[t,...a];m(o)}else if("0"!==b.id){m([t,b])}else m([t])}catch(B){console.debug(B)}},inputField:U}),(0,h.tZ)(d.Z,{handleChange:t=>{"0"!==t.id?(v(t),J(f.id,f.name,{direction:t.id})):(v({id:"0",name:"\u2e3a",type:""}),J(f.id,f.name,{direction:"0"}));U.current.value=""},selection:n,stop:b})]}),(0,h.tZ)(u.Z,{products:[E,A,O,j,x,C,P],productSetters:[k,L,T,W,z,I,q],getData:t=>J(f.id,f.name,t)}),(0,h.tZ)(p.Z,{time:F,setTime:t=>{const e=new Date(t).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T"),n=new Date(t).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"});N(e),R(n),J(f.id,f.name,{time:e})}}),(0,h.tZ)(g.Z,{stop:f,data:w,error:B,date:Z,mode:"arr"})]})}}}]);
//# sourceMappingURL=985.58be2833.chunk.js.map