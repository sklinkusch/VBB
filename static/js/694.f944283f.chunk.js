"use strict";(self.webpackChunkvbb=self.webpackChunkvbb||[]).push([[694],{5694:(t,e,a)=>{a.r(e),a.d(e,{default:()=>f});var i=a(5043),n=a(3216),o=a(5475),r=a(9108),s=a(6992),c=a(3192),d=a(9786),l=a(8266),u=a(750),g=a(354),p=a(4300),m=a(5508),h=a(7483);function f(){const[t,e]=(0,r.AZ)("selection",[]),[a,f]=(0,r.AZ)("filterSelection",[]),[y,b]=(0,r.AZ)("stop",{id:"",name:"",type:""}),[v,w]=(0,r.AZ)("filterStop",{id:"0",name:"\u2e3a",type:""}),[S,A]=(0,r.AZ)("data",[]),[Z,D]=(0,r.AZ)("date",""),[B,E]=(0,r.AZ)("error",null),[k,x]=(0,r.AZ)("express",!0),[Y,L]=(0,r.AZ)("regional",!0),[j,T]=(0,r.AZ)("suburban",!0),[O,P]=(0,r.AZ)("subway",!0),[W,z]=(0,r.AZ)("tram",!0),[C,F]=(0,r.AZ)("bus",!0),[I,q]=(0,r.AZ)("ferry",!0),[N,R]=(0,r.AZ)("time",(new Date).toLocaleString("sv",{timeZone:"Europe/Berlin",minute:"2-digit",hour:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}).replace(" ","T")),G=(0,n.g)(),[H,J]=(0,o.useSearchParams)(),K=(0,n.Zp)();(0,i.useEffect)((()=>{!async function(){if(G.hasOwnProperty("id")&&"string"===typeof G.id&&9===G.id.length)try{const t="https://vbb-rest.vercel.app/stops/".concat(G.id,"?language=de"),a=await fetch(t),i=await a.json(),{name:n}=await i;K("/arrivals/".concat(G.id)),b(i);const o=H.has("direction")&&H.get("direction")?H.get("direction"):"0";if("string"===typeof o&&"0"!==o){const t="https://vbb-rest.vercel.app/stops/".concat(o,"?language=de"),e=await fetch(t),a=await e.json(),{name:i}=await a;w({id:o,name:i,type:""})}else w({id:"0",name:"\u2e3a",type:""});const r=H.has("express")&&H.get("express")?H.get("express"):"false";x("true"===r),U(G.id,n,{direction:o,express:k}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(n):"Arrivals at ".concat(n);e([i])}catch(B){console.debug(B)}else if(G.hasOwnProperty("id")&&"string"===typeof G.id&&12===G.id.length)try{const t="".concat(G.id.slice(0,1)).concat(G.id.slice(-8)),a="https://vbb-rest.vercel.app/stops/".concat(t,"?language=de"),i=await fetch(a),n=await i.json(),{name:o}=await n;K("/arrivals/".concat(t)),b(n),U(t,o,{direction:"0"}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(o):"Arrivals at ".concat(o);e([n])}catch(B){console.debug(B)}else try{const t="900100011",a="https://vbb-rest.vercel.app/stops/".concat(t,"?language=de"),i=await fetch(a),n=await i.json(),{name:o}=await n;K("/arrivals/".concat(t)),b(n),U(t,o,{direction:"0"}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(o):"Arrivals at ".concat(o);e([n])}catch(B){console.debug(B)}}()}),[]);const M=(0,i.useRef)(null),Q=(0,i.useRef)(null),U=async(t,e,a)=>{try{const i=e.startsWith("Berlin")?"BLN":"BBG",n=(0,s.D)(i);let o="de";o=navigator.language.startsWith("de")?"de":"en";const r=a.direction?"0"!==a.direction?parseInt(a.direction,10):null:"0"!==v.id?parseInt(v.id,10):null,c="number"===typeof r?"&direction=".concat(r):"";if((t===y.id||""===Z)&&!a.time){const t=(new Date).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}),e=(new Date).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T");D(t),R(e)}const d="https://vbb-rest.vercel.app/stops/".concat(t,"/arrivals?language=").concat(o,"&duration=").concat(n,"&express=").concat("boolean"===typeof a.express?a.express.toString():k.toString(),"&regional=").concat("boolean"===typeof a.regional?a.regional.toString():Y.toString(),"&suburban=").concat("boolean"===typeof a.suburban?a.suburban.toString():j.toString(),"&subway=").concat("boolean"===typeof a.subway?a.subway.toString():O.toString(),"&tram=").concat("boolean"===typeof a.tram?a.tram.toString():W.toString(),"&bus=").concat("boolean"===typeof a.bus?a.bus.toString():C.toString(),"&ferry=").concat("boolean"===typeof a.ferry?a.ferry.toString():I.toString()).concat(c,"&when=").concat("string"===typeof a.time?new Date(a.time).toISOString():new Date(N).toISOString()),l=await fetch(d),{status:u}=await l,g=await l.json();if(500===u||200!==u)E("HTTP status code: ".concat(u)),A([]);else{const{arrivals:t}=g;document.title="de"===o?"Ank\xfcnfte an ".concat(e):"Arrivals at ".concat(e),A(t),E(null)}}catch(B){console.debug(B)}};return(0,h.FD)("div",{className:"timetable",children:[(0,h.Y)(c.A,{filterStops:async t=>{const a=t.target.value;try{if(a.length>4){const t="https://vbb-rest.vercel.app/locations?query=".concat(a,"&results=15&fuzzy=true&stops=true&addresses=false&poi=false&language=de&linesOfStops=true"),i=await fetch(t),n=await i.json(),o=[y,...n];e(o)}else e([y])}catch(B){console.debug(B)}},inputField:M}),(0,h.Y)(d.A,{handleChange:t=>{b(t);const{id:e,name:a}=t;U(e,a,{direction:"0"});M.current.value=""},selection:t,stop:y,mode:"arr"}),(0,h.Y)(l.A,{handleSubmit:()=>{const t=(new Date).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}),e=(new Date).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T");D(t),R(e),U(y.id,y.name,{direction:v.id,time:e});M.current.value=""}}),(0,h.FD)("div",{children:[(0,h.Y)("span",{sx:{display:"inline-block",mr:"0.2rem",fontStyle:"italic",fontWeight:700},children:"via"}),(0,h.Y)(c.A,{filterStops:async t=>{const e=t.target.value;try{const t={id:"0",name:"\u2e3a",type:""};if(e.length>=3){const a="https://vbb-rest.vercel.app/locations?query=".concat(e,"&results=15&fuzzy=true&stops=true&addresses=false&poi=false&language=de&linesOfStops=true"),i=await fetch(a),n=await i.json(),o="0"!==v.id?[t,v,...n]:[t,...n];f(o)}else if("0"!==v.id){f([t,v])}else f([t])}catch(B){console.debug(B)}},inputField:Q}),(0,h.Y)(u.A,{handleChange:t=>{"0"!==t.id?(w(t),J({direction:t.id}),U(y.id,y.name,{direction:t.id})):(w({id:"0",name:"\u2e3a",type:""}),J({direction:"0"}),U(y.id,y.name,{direction:"0"}));Q.current.value=""},selection:a,stop:v})]}),(0,h.Y)(g.A,{products:[k,Y,j,O,W,C,I],productSetters:[x,L,T,P,z,F,q],getData:t=>U(y.id,y.name,t),searchParams:H,setSearchParams:J}),(0,h.Y)(m.A,{time:N,setTime:t=>{const e=new Date(t).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T"),a=new Date(t).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"});R(e),D(a),U(y.id,y.name,{direction:v.id,time:e})}}),(0,h.Y)(p.A,{stop:y,data:S,error:B,date:Z,mode:"arr"})]})}}}]);
//# sourceMappingURL=694.f944283f.chunk.js.map