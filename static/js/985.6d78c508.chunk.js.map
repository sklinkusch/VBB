{"version":3,"file":"static/js/985.6d78c508.chunk.js","mappings":"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","sources":["components/TimetableArr/TimetableArr.tsx"],"sourcesContent":["import React, { useRef, useEffect, lazy } from \"react\"\nimport { useParams, useNavigate } from \"react-router-dom\"\nimport { useDebugState } from \"use-named-state\"\nimport axios from \"axios\"\nimport { getDuration } from \"../helpers/helpers\"\nimport stops from \"../../data/stops\"\nconst Input = lazy(() => import(\"../Input/Input\"))\nconst Select = lazy(() => import(\"../Select/Select\"))\nconst Button = lazy(() => import(\"../Button/Button\"))\nconst Filter = lazy(() => import(\"../Filter/Filter\"))\nconst StopBody = lazy(() => import(\"../StopBody/StopBody\"))\n/* eslint-disable react-hooks/exhaustive-deps */\n\ntype Location = {\n\ttype: \"location\"\n\tlatitude: number\n\tlongitude: number\n}\n\ntype Remarks = {\n\tcode: string | undefined\n\tsummary: string | null | undefined\n\ttext: string\n\ttype: string\n\tvalidFrom: string | undefined\n\tvalidUntil: string | undefined\n}[]\n\ntype LINE_A = {\n\tcolor: {\n\t\tfg: string\n\t\tbg: string\n\t}\n\texpress: boolean\n\tfahrtNr: string\n\tid: string\n\tmetro: boolean\n\tmode: string\n\tname: string\n\tnight: boolean\n\tnr: number\n\tproduct: \"regional\" | \"suburban\" | \"subway\"\n\ttype: string\n}\n\ntype LINE_B = {\n\texpress: boolean\n\tfahrtNr: string\n\tid: string\n\tmetro: boolean\n\tmode: string\n\tname: string\n\tnight: boolean\n\tnr: number\n\tproduct: \"express\" | \"tram\" | \"bus\" | \"ferry\"\n\ttype: string\n}\n\ntype Dataset = {\n\tcancelled: boolean | undefined\n\tcurrentTripPosition: Location\n\tdelay: number | null\n\tdirection: string | null\n\tformerScheduledWhen?: string\n\tline: LINE_A | LINE_B\n\tplannedPlatform?: string\n\tplannedWhen?: string\n\tplatform?: number | string\n\tprognosedPlatform?: string\n\tprognosisType: string | null | undefined\n\tprovenance: string | null\n\tremarks: Remarks\n\tscheduledWhen?: string\n\tstop: {\n\t\tid: string\n\t\tname: string\n\t\tlocation: Location\n\t}\n\ttripId: string\n\twhen?: string\n}\n\ntype Stop = {\n\tid: string\n\tname: string\n\ttype?: string\n}\n\ntype Data = Dataset[]\n\nexport default function TimetableArr() {\n\tconst [selection, setSelection] = useDebugState<Stop[]>(\"selection\", stops)\n\tconst [stop, setStop] = useDebugState<Stop>(\"stop\", {\n\t\tid: \"\",\n\t\tname: \"\",\n\t\ttype: \"\",\n\t})\n\tconst [data, setData] = useDebugState<Data>(\"data\", [])\n\tconst [date, setDate] = useDebugState<string>(\"date\", \"\")\n\tconst [viewData, setViewData] = useDebugState<Data>(\"viewData\", [])\n\tconst [error, setError] = useDebugState<any>(\"error\", null)\n\tconst params = useParams()\n\tconst navigate = useNavigate()\n\tuseEffect(() => {\n\t\tif (\n\t\t\tparams.hasOwnProperty(\"id\") &&\n\t\t\ttypeof params.id === \"string\" &&\n\t\t\tparams.id.length > 0\n\t\t) {\n\t\t\tconst selectedStop = stops.filter((stop) => stop.id === params.id)[0]\n\t\t\tnavigate(`/arrivals/${params.id}`)\n\t\t\tsetStop(selectedStop)\n\t\t\tgetData(params.id)\n\t\t\tconst remainingStops = stops.filter(\n\t\t\t\t(stop) => stop.name !== selectedStop.name\n\t\t\t)\n\t\t\tdocument.title = navigator.language.startsWith(\"de\")\n\t\t\t\t? `Ankünfte an ${selectedStop.name}`\n\t\t\t\t: `Arrivals at ${selectedStop.name}`\n\t\t\tconst stopSelection = [selectedStop, ...remainingStops]\n\t\t\tsetSelection(stopSelection)\n\t\t} else {\n\t\t\tconst initialStopArray = stops.filter(\n\t\t\t\t(stop) => stop.name === \"U Stadtmitte\"\n\t\t\t)\n\t\t\tconst [initialStop] = initialStopArray\n\t\t\tconst { id: initialId } = initialStop\n\t\t\tnavigate(`/arrivals/${initialId}`)\n\t\t\tsetStop(initialStop)\n\t\t\tgetData(initialId)\n\t\t\tconst remainingStops = stops.filter(\n\t\t\t\t(stop) => stop.name !== initialStop.name\n\t\t\t)\n\t\t\tdocument.title = navigator.language.startsWith(\"de\")\n\t\t\t\t? `Ankünfte an U Stadtmitte`\n\t\t\t\t: `Arrivals at U Stadtmitte`\n\t\t\tconst stopSelection = [initialStop, ...remainingStops]\n\t\t\tsetSelection(stopSelection)\n\t\t}\n\t}, [])\n\tconst inputField = useRef<HTMLInputElement>(null)\n\tconst filterField = useRef<HTMLInputElement>(null)\n\tconst filterSelector = useRef<HTMLSelectElement>(null)\n\tconst filterData = () => {\n\t\tconst fieldCurrent = filterField.current as HTMLInputElement\n\t\tconst { value: fieldValue } = fieldCurrent\n\t\tconst filterValues = fieldValue.split(\" \")\n\t\tconst selectorCurrent = filterSelector.current as HTMLSelectElement\n\t\tconst { value: filterMode } = selectorCurrent\n\t\tif (filterValues.length > 0) {\n\t\t\tif (filterMode === \"OR\") {\n\t\t\t\tfilterOr(filterValues)\n\t\t\t} else {\n\t\t\t\tfilterAnd(filterValues)\n\t\t\t}\n\t\t} else {\n\t\t\tnoFilters()\n\t\t}\n\t}\n\tconst filterOr = (filterValues: string[]) => {\n\t\tconst filteredData = data.filter((arrival) => {\n\t\t\tlet decider = false\n\t\t\tif (arrival.hasOwnProperty(\"provenance\") && arrival.provenance) {\n\t\t\t\tfor (let i = 0; i < filterValues.length; i++) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tarrival.line.name\n\t\t\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t\t\t.includes(filterValues[i].toLowerCase()) ||\n\t\t\t\t\t\tarrival.provenance\n\t\t\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t\t\t.includes(filterValues[i].toLowerCase())\n\t\t\t\t\t) {\n\t\t\t\t\t\tdecider = true\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn decider\n\t\t})\n\t\tsetViewData(filteredData)\n\t}\n\tconst filterAnd = (filterValues: string[]) => {\n\t\tconst filteredData = data.filter((arrival) => {\n\t\t\tlet decider = true\n\t\t\tif (arrival.hasOwnProperty(\"provenance\") && arrival.provenance) {\n\t\t\t\tfor (let i = 0; i < filterValues.length; i++) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tarrival.line.name\n\t\t\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t\t\t.includes(filterValues[i].toLowerCase()) ||\n\t\t\t\t\t\tarrival.provenance\n\t\t\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t\t\t.includes(filterValues[i].toLowerCase())\n\t\t\t\t\t) {\n\t\t\t\t\t\tcontinue\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdecider = false\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn decider\n\t\t})\n\t\tsetViewData(filteredData)\n\t}\n\tconst noFilters = () => {\n\t\tsetViewData(data)\n\t}\n\tconst filterStops = (filterValue: string) => {\n\t\tconst remainingStops = stops.filter(\n\t\t\t(currStop) =>\n\t\t\t\tcurrStop.id !== stop.id &&\n\t\t\t\tcurrStop.name.toLowerCase().includes(filterValue.toLowerCase())\n\t\t)\n\t\tconst newSelection = [stop, ...remainingStops]\n\t\tsetSelection(newSelection)\n\t}\n\tconst doFilter = (event: { key: string; target: { value: string } }) => {\n\t\t// if (event.key === \"Enter\") {\n\t\tconst filterValue = event.target.value\n\t\tfilterStops(filterValue)\n\t\t// }\n\t}\n\tconst setCurrStop = (currStop: Stop) => {\n\t\tsetStop(currStop)\n\t}\n\tconst getData = async (id: string) => {\n\t\tconst currentStopArray = stops.filter((stop) => stop.id === id)\n\t\tconst [currentStop] = currentStopArray\n\t\tconst { type = \"BBG\" } = currentStop\n\t\tconst duration = getDuration(type)\n\t\tlet lang = \"de\"\n\t\tconst browserLang = navigator.language\n\t\tif (browserLang.startsWith(\"de\")) {\n\t\t\tlang = \"de\"\n\t\t} else {\n\t\t\tlang = \"en\"\n\t\t}\n\t\tconst url = `https://sklinkusch-vbbmicro.vercel.app/?station=${id}&duration=${duration}&mode=arr&language=${lang}`\n\t\tconst response = await axios.get(url)\n\t\tconst { data: resData, status } = await response\n\t\tif (status === 500 || status !== 200) {\n\t\t\tsetError(`HTTP status code: ${status}`)\n\t\t\tsetData([])\n\t\t} else {\n\t\t\tconst myDate = new Date().toLocaleString(\"de-DE\", {\n\t\t\t\tyear: \"numeric\",\n\t\t\t\tmonth: \"2-digit\",\n\t\t\t\tday: \"2-digit\",\n\t\t\t\thour: \"2-digit\",\n\t\t\t\tminute: \"2-digit\",\n\t\t\t\ttimeZone: \"Europe/Berlin\",\n\t\t\t})\n\t\t\tdocument.title =\n\t\t\t\tlang === \"de\"\n\t\t\t\t\t? `Ankünfte an ${currentStop.name}`\n\t\t\t\t\t: `Arrivals at ${currentStop.name}`\n\t\t\tsetDate(myDate)\n\t\t\tsetData(resData)\n\t\t\tsetViewData(resData)\n\t\t\tsetError(null)\n\t\t}\n\t}\n\tconst handleChange = (currentStop: Stop) => {\n\t\tsetCurrStop(currentStop)\n\t\tconst { id: myStopId } = currentStop\n\t\tgetData(myStopId)\n\t\tconst inputCurrent = inputField.current as HTMLInputElement\n\t\tinputCurrent.value = \"\"\n\t\tconst filterFieldCurrent = filterField.current as HTMLInputElement\n\t\tfilterFieldCurrent.value = \"\"\n\t\tconst filterSelectorCurrent = filterSelector.current as HTMLSelectElement\n\t\tfilterSelectorCurrent.value = \"OR\"\n\t}\n\tconst handleSubmit = () => {\n\t\tgetData(stop.id)\n\t\tconst inputCurrent = inputField.current as HTMLInputElement\n\t\tinputCurrent.value = \"\"\n\t\tconst filterFieldCurrent = filterField.current as HTMLInputElement\n\t\tfilterFieldCurrent.value = \"\"\n\t\tconst filterSelectorCurrent = filterSelector.current as HTMLSelectElement\n\t\tfilterSelectorCurrent.value = \"OR\"\n\t}\n\t// useEffect(() => {\n\t//   getData(stop);\n\t// }, []);\n\treturn (\n\t\t<div className=\"timetable\">\n\t\t\t<Input filterStops={doFilter} inputField={inputField} />\n\t\t\t<Select\n\t\t\t\thandleChange={handleChange}\n\t\t\t\tselection={selection}\n\t\t\t\tstop={stop}\n\t\t\t\tmode=\"arr\"\n\t\t\t/>\n\t\t\t<Button handleSubmit={handleSubmit} />\n\t\t\t<Filter\n\t\t\t\tfilterField={filterField}\n\t\t\t\tfilterSelector={filterSelector}\n\t\t\t\tfilterData={filterData}\n\t\t\t\tmode=\"arr\"\n\t\t\t/>\n\t\t\t<StopBody\n\t\t\t\tstop={stop}\n\t\t\t\tdata={viewData}\n\t\t\t\terror={error}\n\t\t\t\tdate={date}\n\t\t\t\tmode=\"arr\"\n\t\t\t/>\n\t\t</div>\n\t)\n}\n"],"names":["Input","lazy","Select","Button","Filter","StopBody","TimetableArr","useDebugState","stops","selection","setSelection","id","name","type","stop","setStop","data","setData","date","setDate","viewData","setViewData","error","setError","params","useParams","navigate","useNavigate","useEffect","hasOwnProperty","length","selectedStop","getData","remainingStops","document","title","navigator","language","startsWith","stopSelection","initialStopArray","initialStop","initialId","inputField","useRef","filterField","filterSelector","filterOr","filterValues","filteredData","filter","arrival","decider","provenance","i","line","toLowerCase","includes","filterAnd","noFilters","currentStopArray","currentStop","duration","getDuration","lang","browserLang","url","axios","response","resData","status","myDate","Date","toLocaleString","year","month","day","hour","minute","timeZone","className","filterStops","event","filterValue","currStop","newSelection","target","value","handleChange","myStopId","current","mode","handleSubmit","filterData","split","filterMode"],"sourceRoot":""}