{"version":3,"sources":["components/TimetableArr.js"],"names":["Input","lazy","__webpack_require__","e","then","bind","Select","Button","Filter","StopBody","Timetable","props","_useState","useState","stops","allStops","Object","_development_stefan_react_vbb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","_useState3","_useState4","selection","setSelection","_useState5","_useState6","stop","setStop","_useState7","_useState8","data","setData","_useState9","_useState10","viewData","setViewData","_useState11","_useState12","error","setError","useEffect","initialStopArray","filter","name","initialStop","initialId","id","getData","remainingStops","stopSelection","concat","_development_stefan_react_vbb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__","inputField","useRef","filterField","filterSelector","filterOr","filterValues","filteredData","arrival","decider","i","length","line","toLowerCase","includes","direction","filterAnd","noFilters","_ref","_development_stefan_react_vbb_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_development_stefan_react_vbb_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","mark","_callee","currentStopArray","_currentStopArray","currentStop","_currentStop$type","type","duration","url","response","_yield$response","resData","status","wrap","_context","prev","next","getDuration","axios","get","sent","_x","apply","this","arguments","react__WEBPACK_IMPORTED_MODULE_4___default","createElement","className","filterStops","event","filterValue","currStop","newSelection","target","value","handleChange","myStopId","current","handleSubmit","filterData","split","filterMode","mode"],"mappings":"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","file":"static/js/28.5b955680.chunk.js","sourcesContent":["import React, { useState, useRef, useEffect, lazy } from \"react\"\nimport axios from \"axios\"\nimport { getDuration } from \"../components/helpers\"\nimport stops from \"../data/stops\"\nconst Input = lazy(() => import(\"./Input\"))\nconst Select = lazy(() => import(\"./Select\"))\nconst Button = lazy(() => import(\"./Button\"))\nconst Filter = lazy(() => import(\"./Filter\"))\nconst StopBody = lazy(() => import(\"./StopBody\"))\n/* eslint-disable react-hooks/exhaustive-deps */\n\nexport default function Timetable(props) {\n  const [allStops] = useState(stops)\n  const [selection, setSelection] = useState(stops)\n  const [stop, setStop] = useState({})\n  const [data, setData] = useState([])\n  const [viewData, setViewData] = useState([])\n  const [error, setError] = useState(null)\n  useEffect(() => {\n    const initialStopArray = stops.filter(\n      (stop) => stop.name === \"U Stadtmitte\"\n    )\n    const [initialStop] = initialStopArray\n    const { id: initialId } = initialStop\n    setStop(initialStop)\n    getData(initialId)\n    const remainingStops = allStops.filter(\n      (stop) => stop.name !== initialStop.name\n    )\n    const stopSelection = [initialStop, ...remainingStops]\n    setSelection(stopSelection)\n  }, []) \n  const inputField = useRef(null)\n  const filterField = useRef(null)\n  const filterSelector = useRef(null)\n  const filterData = (event) => {\n    const { current: fieldCurrent } = filterField\n    const { value: fieldValue } = fieldCurrent\n    const filterValues = fieldValue.split(\" \")\n    const { current: selectorCurrent } = filterSelector\n    const { value: filterMode } = selectorCurrent\n    if (filterValues.length > 0) {\n      if (filterMode === \"OR\") {\n        filterOr(filterValues)\n      } else {\n        filterAnd(filterValues)\n      }\n    } else {\n      noFilters()\n    }\n  }\n  const filterOr = (filterValues) => {\n    const filteredData = data.filter((arrival) => {\n      let decider = false\n      for (let i = 0; i < filterValues.length; i++) {\n        if (\n          arrival.line.name\n            .toLowerCase()\n            .includes(filterValues[i].toLowerCase()) ||\n          arrival.direction\n            .toLowerCase()\n            .includes(filterValues[i].toLowerCase())\n        ) {\n          decider = true\n          break\n        }\n      }\n      return decider\n    })\n    setViewData(filteredData)\n  }\n  const filterAnd = (filterValues) => {\n    const filteredData = data.filter((arrival) => {\n      let decider = true\n      for (let i = 0; i < filterValues.length; i++) {\n        if (\n          arrival.line.name\n            .toLowerCase()\n            .includes(filterValues[i].toLowerCase()) ||\n          arrival.direction\n            .toLowerCase()\n            .includes(filterValues[i].toLowerCase())\n        ) {\n          continue\n        } else {\n          decider = false\n          break\n        }\n      }\n      return decider\n    })\n    setViewData(filteredData)\n  }\n  const noFilters = () => {\n    setViewData(data)\n  }\n  const filterStops = (filterValue) => {\n    const remainingStops = allStops.filter(\n      (currStop) =>\n        currStop.id !== stop.id &&\n        currStop.name.toLowerCase().includes(filterValue.toLowerCase())\n    )\n    const newSelection = [stop, ...remainingStops]\n    setSelection(newSelection)\n  }\n  const doFilter = (event) => {\n    // if (event.key === \"Enter\") {\n    const filterValue = event.target.value\n    filterStops(filterValue)\n    // }\n  }\n  const setCurrStop = (currStop) => {\n    setStop(currStop)\n  }\n  const getData = async (id) => {\n    const currentStopArray = allStops.filter((stop) => stop.id === id)\n    const [currentStop] = currentStopArray\n    const { type = \"BBG\" } = currentStop\n    const duration = getDuration(type)\n    const url = `https://sklinkusch-vbbmicro.vercel.app/?station=${id}&duration=${duration}&mode=arr`\n    const response = await axios.get(url)\n    const { data: resData, status } = await response\n    if (status === 500 || status !== 200) {\n      setError(`HTTP status code: ${status}`)\n      setData([])\n    } else {\n      setData(resData)\n      setViewData(resData)\n      setError(null)\n    }\n  }\n  const handleChange = (currentStop) => {\n    setCurrStop(currentStop)\n    const { id: myStopId } = currentStop\n    getData(myStopId)\n    inputField.current.value = \"\"\n    filterField.current.value = \"\"\n    filterSelector.current.value = \"OR\"\n  }\n  const handleSubmit = () => {\n    getData(stop.id)\n    inputField.current.value = \"\"\n    filterField.current.value = \"\"\n    filterSelector.current.value = \"OR\"\n  }\n  // useEffect(() => {\n  //   getData(stop);\n  // }, []);\n  return (\n    <div className=\"timetable\">\n      <Input filterStops={doFilter} inputField={inputField} />\n      <Select handleChange={handleChange} selection={selection} stop={stop} />\n      <Button handleSubmit={handleSubmit} />\n      <Filter\n        filterField={filterField}\n        filterSelector={filterSelector}\n        filterData={filterData}\n        mode=\"arr\"\n      />\n      <StopBody stop={stop} data={viewData} error={error} mode=\"arr\" />\n    </div>\n  )\n}\n"],"sourceRoot":""}