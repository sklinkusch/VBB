"use strict";(self.webpackChunkvbb=self.webpackChunkvbb||[]).push([[207],{9207:function(e,n,t){t.r(n),t.d(n,{getDelay:function(){return v},getPlanTime:function(){return y},getTime:function(){return Z}});var r=t(9439),a=t(2791),i=t(4373),d=t(9922),o=(0,a.lazy)((function(){return t.e(599).then(t.bind(t,8705))})),l=(0,a.lazy)((function(){return t.e(305).then(t.bind(t,6305))})),c=(0,a.lazy)((function(){return t.e(272).then(t.bind(t,5272))})),u=(0,a.lazy)((function(){return t.e(48).then(t.bind(t,1048))})),s=(0,a.lazy)((function(){return Promise.resolve().then(t.bind(t,6049))})),p=(0,a.lazy)((function(){return t.e(302).then(t.bind(t,6302))})),f=(0,a.lazy)((function(){return t.e(734).then(t.bind(t,734))})),h=(0,a.lazy)((function(){return t.e(619).then(t.bind(t,619))})),m=(0,a.lazy)((function(){return t.e(776).then(t.bind(t,7776))})),b=(0,a.lazy)((function(){return t.e(558).then(t.bind(t,4558))})),g=(0,a.lazy)((function(){return t.e(525).then(t.bind(t,1525))})),v=function(e,n){if(null!=e){var t=Math.abs(e/60);return Math.round(t)}return n?"X":"?"},y=function(e,n){var t=Number(e.substring(0,2)),r=Number(e.substring(3,5));(r-=n)<0&&(r+=60,t-=1),r>59&&(r-=60,t+=1),t<0&&(t+=24),t>23&&(t-=24);var a=t<10?"0".concat(t):"".concat(t),i=r<10?"0".concat(r):"".concat(r);return"".concat(a,":").concat(i)},Z=function(e){return null!=e?e.substring(11,16):""};n.default=function(e){var n=(0,a.useState)(null),t=(0,r.Z)(n,2),k=t[0],x=t[1],z=(0,a.useState)(void 0),C=(0,r.Z)(z,2),M=C[0],w=C[1],N=function(e){var n=4*Math.atan(1),t=e.currentTripPosition,r=e.stop;if(t){var a=t.latitude,i=t.longitude;fetch("https://vbb-rest.vercel.app/locations/nearby?latitude=".concat(a,"&longitude=").concat(i,"&results=10&language=de")).then((function(e){return e.json()})).then((function(n){return n.filter((function(n){return!0===n.products[e.line.product]}))})).then((function(e){e.length>0&&e[0].name&&x(e[0].name)}));var d=r.location,o=n*a/180,l=n*d.latitude/180,c=n*(i-d.longitude)/180,u=Math.sin(o)*Math.sin(l)+Math.cos(o)*Math.cos(l)*Math.cos(c);return 60*(180*Math.acos(u)/n)*1.1515}return null}(e.dep);(0,a.useEffect)((function(){fetch("https://vbb-rest.vercel.app/trips/".concat(e.dep.tripId,"?language=de")).then((function(e){return e.json()})).then((function(e){return w(e.trip)}))}),[]);var P,B=e.dep.cancelled?v(e.dep.delay,e.dep.cancelled):v(e.dep.delay,!1);if("number"===typeof e.dep.delay&&"number"===typeof B){var T=e.dep.delay<0?"\u2013":e.dep.delay>0?"+":"\xb1";P="".concat(T).concat(B)}else P=B;var X,A=Z(e.dep.when);null!=e.dep.when&&null!=e.dep.delay?X=y(A,Number(B)):null!=e.dep.when&&"?"===B?(X=A,A=""):X=Z(e.dep.formerScheduledWhen)||Z(e.dep.scheduledWhen)||Z(e.dep.plannedWhen);var I=e.dep,W=I.line,S=I.direction,j=I.remarks,F=I.platform,D=I.plannedPlatform,E=I.prognosedPlatform;return(0,d.BX)(a.Fragment,{children:[(0,d.BX)("div",{className:"row",sx:{display:"grid",gridTemplateColumns:["repeat(24,1fr)","repeat(24,1fr)","repeat(26,1fr)"]},children:[(0,d.tZ)(c,{time:X,class:"plantime"}),(0,d.tZ)(c,{time:A,class:"realtime"}),(0,d.tZ)("div",{className:"delay",sx:{textAlign:["center","center","right"],gridColumn:["17 / span 8","5 / span 2"]},children:P}),(0,d.tZ)(u,{line:W}),(0,d.tZ)(s,{line:W}),(0,d.tZ)("div",{className:"direction",sx:{textAlign:"left",gridColumn:["8 / span 13","11 / span 8"]},children:S}),(0,d.tZ)("div",{className:"platform",sx:{textAlign:"center",gridColumn:["22 / span 3","19 / span 2"]},children:F||D||E}),(0,d.tZ)(p,{remarks:j}),(0,d.tZ)(f,{remarks:j}),(0,d.tZ)(h,{remarks:j}),(0,d.tZ)(m,{remarks:j}),(0,d.tZ)(o,{operator:W.operator})]},e.dep.tripId),(0,d.BX)("div",{className:"row row-add",sx:{display:"grid",gridTemplateColumns:"repeat(24, 1fr)",borderBottom:["1px solid #ccc","1px solid #ccc","none"]},children:[k&&N&&(0,d.tZ)(i.r,{position:k,distance:N}),M&&(0,d.tZ)(l,{trip:M,stopId:e.dep.stop.id,mode:"dep"}),(0,d.tZ)(b,{remarks:j}),(0,d.tZ)(g,{remarks:j})]},"add:".concat(e.dep.tripId))]})}},4373:function(e,n,t){t.d(n,{r:function(){return a}});var r=t(9922);function a(e){var n=e.position,t=e.distance;return n&&t?(0,r.BX)("div",{sx:{gridColumn:"1 / 25"},children:[navigator.language.startsWith("de")?"Aktuelle Position: ":"Current Position: ",(0,r.tZ)("span",{children:n})," ","(",t.toFixed(3)," km)"]}):(0,r.tZ)("div",{})}}}]);
//# sourceMappingURL=207.846f97d6.chunk.js.map