"use strict";(self.webpackChunkvbb=self.webpackChunkvbb||[]).push([[985],{2985:(t,e,a)=>{a.r(e),a.d(e,{default:()=>m});var n=a(2791),i=a(7689),o=a(5918),r=a(2530),c=a(4307),s=a(6313),l=a(3090),d=a(953),u=a(1036),g=a(1029),p=a(4994),h=a(9922);function m(){const[t,e]=(0,o.Rh)("selection",[]),[a,m]=(0,o.Rh)("filterSelection",[]),[f,y]=(0,o.Rh)("stop",{id:"",name:"",type:""}),[b,v]=(0,o.Rh)("filterStop",{id:"0",name:"\u2e3a",type:""}),[w,S]=(0,o.Rh)("data",[]),[Z,R]=(0,o.Rh)("date",""),[B,D]=(0,o.Rh)("error",null),[k,E]=(0,o.Rh)("express",!0),[A,L]=(0,o.Rh)("regional",!0),[O,T]=(0,o.Rh)("suburban",!0),[j,W]=(0,o.Rh)("subway",!0),[x,z]=(0,o.Rh)("tram",!0),[C,I]=(0,o.Rh)("bus",!0),[P,q]=(0,o.Rh)("ferry",!0),[F,N]=(0,o.Rh)("time",(new Date).toLocaleString("sv",{timeZone:"Europe/Berlin",minute:"2-digit",hour:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}).replace(" ","T")),X=(0,i.UO)(),G=(0,i.s0)();(0,n.useEffect)((()=>{!async function(){if(X.hasOwnProperty("id")&&"string"===typeof X.id&&9===X.id.length)try{const t="https://vbb-rest.vercel.app/stops/".concat(X.id,"?language=de"),a=await fetch(t),n=await a.json(),{name:i}=await n;G("/arrivals/".concat(X.id)),y(n),J(X.id,i,{direction:"0"}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(i):"Arrivals at ".concat(i);e([n])}catch(B){console.debug(B)}else if(X.hasOwnProperty("id")&&"string"===typeof X.id&&12===X.id.length)try{const t="".concat(X.id.slice(0,1)).concat(X.id.slice(-8)),a="https://vbb-rest.vercel.app/stops/".concat(t,"?language=de"),n=await fetch(a),i=await n.json(),{name:o}=await i;G("/arrivals/".concat(t)),y(i),J(t,o,{direction:"0"}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(o):"Arrivals at ".concat(o);e([i])}catch(B){console.debug(B)}else try{const t="900100011",a="https://vbb-rest.vercel.app/stops/".concat(t,"?language=de"),n=await fetch(a),i=await n.json(),{name:o}=await i;G("/arrivals/".concat(t)),y(i),J(t,o,{direction:"0"}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(o):"Arrivals at ".concat(o);e([i])}catch(B){console.debug(B)}}()}),[]);const H=(0,n.useRef)(null),U=(0,n.useRef)(null),J=async(t,e,a)=>{try{const n=e.startsWith("Berlin")?"BLN":"BBG",i=(0,r.g)(n);let o="de";o=navigator.language.startsWith("de")?"de":"en";const c=a.direction?"0"!==a.direction?parseInt(a.direction,10):null:"0"!==b.id?parseInt(b.id,10):null,s="number"===typeof c?"&direction=".concat(c):"";if((t===f.id||""===Z)&&!a.time){const t=(new Date).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}),e=(new Date).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T");R(t),N(e)}const l="https://vbb-rest.vercel.app/stops/".concat(t,"/arrivals?language=").concat(o,"&duration=").concat(i,"&express=").concat("boolean"===typeof a.express?a.express.toString():k.toString(),"&regional=").concat("boolean"===typeof a.regional?a.regional.toString():A.toString(),"&suburban=").concat("boolean"===typeof a.suburban?a.suburban.toString():O.toString(),"&subway=").concat("boolean"===typeof a.subway?a.subway.toString():j.toString(),"&tram=").concat("boolean"===typeof a.tram?a.tram.toString():x.toString(),"&bus=").concat("boolean"===typeof a.bus?a.bus.toString():C.toString(),"&ferry=").concat("boolean"===typeof a.ferry?a.ferry.toString():P.toString()).concat(s,"&when=").concat("string"===typeof a.time?new Date(a.time).toISOString():new Date(F).toISOString()),d=await fetch(l),{status:u}=await d,g=await d.json();if(500===u||200!==u)D("HTTP status code: ".concat(u)),S([]);else{const{arrivals:t}=g;document.title="de"===o?"Ank\xfcnfte an ".concat(e):"Arrivals at ".concat(e),S(t),D(null)}}catch(B){console.debug(B)}};return(0,h.BX)("div",{className:"timetable",children:[(0,h.tZ)(c.Z,{filterStops:async t=>{const a=t.target.value;try{if(a.length>4){const t="https://vbb-rest.vercel.app/locations?query=".concat(a,"&results=15&fuzzy=true&stops=true&addresses=false&poi=false&language=de&linesOfStops=true"),n=await fetch(t),i=await n.json(),o=[f,...i];e(o)}else e([f])}catch(B){console.debug(B)}},inputField:H}),(0,h.tZ)(s.Z,{handleChange:t=>{y(t);const{id:e,name:a}=t;J(e,a,{direction:"0"});H.current.value=""},selection:t,stop:f,mode:"arr"}),(0,h.tZ)(l.Z,{handleSubmit:()=>{J(f.id,f.name,{time:(new Date).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T")});H.current.value=""}}),(0,h.BX)("div",{children:[(0,h.tZ)("span",{sx:{display:"inline-block",mr:"0.2rem",fontStyle:"italic",fontWeight:700},children:"via"}),(0,h.tZ)(c.Z,{filterStops:async t=>{const e=t.target.value;try{const t={id:"0",name:"\u2e3a",type:""};if(e.length>=3){const a="https://vbb-rest.vercel.app/locations?query=".concat(e,"&results=15&fuzzy=true&stops=true&addresses=false&poi=false&language=de&linesOfStops=true"),n=await fetch(a),i=await n.json(),o="0"!==b.id?[t,b,...i]:[t,...i];m(o)}else if("0"!==b.id){m([t,b])}else m([t])}catch(B){console.debug(B)}},inputField:U}),(0,h.tZ)(d.Z,{handleChange:t=>{"0"!==t.id?(v(t),J(f.id,f.name,{direction:t.id})):(v({id:"0",name:"\u2e3a",type:""}),J(f.id,f.name,{direction:"0"}));U.current.value=""},selection:a,stop:b})]}),(0,h.tZ)(u.Z,{products:[k,A,O,j,x,C,P],productSetters:[E,L,T,W,z,I,q],getData:t=>J(f.id,f.name,t)}),(0,h.tZ)(p.Z,{time:F,setTime:t=>{const e=new Date(t).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T"),a=new Date(t).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"});N(e),R(a),J(f.id,f.name,{time:e})}}),(0,h.tZ)(g.Z,{stop:f,data:w,error:B,date:Z,mode:"arr"})]})}}}]);
//# sourceMappingURL=985.1677c547.chunk.js.map