{"version":3,"file":"static/js/522.26cc59c2.chunk.js","mappings":"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","sources":["components/Arrival/Arrival.tsx","components/Distance/Distance.tsx"],"sourcesContent":["/** @jsxImportSource theme-ui */\nimport { Fragment, lazy, useState, useEffect } from \"react\"\nimport { Distance } from \"../Distance/Distance\"\nconst Carrier = lazy(() => import(\"../Carrier/Carrier\"))\nconst Trip = lazy(() => import(\"../Trip/Trip\"))\nconst Time = lazy(() => import(\"../Time/Time\"))\nconst Product = lazy(() => import(\"../Product/Product\"))\nconst Line = lazy(() => import(\"../Line/Line\"))\nconst Barrier = lazy(() => import(\"../Barrier/Barrier\"))\nconst Bike = lazy(() => import(\"../Bike/Bike\"))\nconst Warning = lazy(() => import(\"../Warning/Warning\"))\nconst Status = lazy(() => import(\"../Status/Status\"))\nconst Warntext = lazy(() => import(\"../Warntext/Warntext\"))\nconst Stattext = lazy(() => import(\"../Stattext/Stattext\"))\n/* eslint-disable react-hooks/exhaustive-deps */\n\ntype Location = {\n\ttype: \"location\"\n\tlatitude: number\n\tlongitude: number\n}\n\ntype Remarks = {\n\tcode: string | undefined\n\tsummary: string | null | undefined\n\ttext: string | undefined\n\ttype: string | undefined\n\tvalidFrom: string | undefined\n\tvalidUntil: string | undefined\n}[]\n\ntype Operator = {\n  type: \"operator\",\n  id: string,\n  name: string\n}\n\ntype LINE_A = {\n\tcolor: {\n\t\tfg: string\n\t\tbg: string\n\t}\n\texpress: boolean\n\tfahrtNr: string\n\tid: string\n\tmetro: boolean\n\tmode: string\n\tname: string\n\tnight: boolean\n\tnr: number\n\toperator: Operator\n\tproduct: \"regional\" | \"suburban\" | \"subway\"\n\ttype: string\n}\n\ntype LINE_B = {\n\texpress: boolean\n\tfahrtNr: string\n\tid: string\n\tmetro: boolean\n\tmode: string\n\tname: string\n\tnight: boolean\n\tnr: number\n\toperator: Operator\n\tproduct: \"express\" | \"tram\" | \"bus\" | \"ferry\"\n\ttype: string\n}\n\ntype Arr = {\n\tcancelled: boolean | undefined\n\tcurrentTripPosition: Location\n\tdelay: number | null\n\tdirection: string | null\n\tformerScheduledWhen?: string\n\tline: LINE_A | LINE_B\n\tplannedPlatform?: string\n\tplannedWhen?: string\n\tplatform?: number | string\n\tprognosedPlatform?: string\n\tprognosisType: string | null | undefined\n\tprovenance: string | null\n\tremarks: Remarks\n\tscheduledWhen?: string\n\tstop: {\n\t\tid: string\n\t\tname: string\n\t\tlocation: Location\n\t}\n\ttripId: string\n\twhen?: string\n}\n\ntype Props = {\n\tarr: Arr\n}\n\ntype SingleStop = {\n\ttype: \"stop\"\n\tid: string\n\tname: string\n\tlocation: Location\n\tdistance: number\n\tstationDHID: string\n\tproducts: {\n\t\tsuburban: boolean\n\t\tsubway: boolean\n\t\ttram: boolean\n\t\tbus: boolean\n\t\tferry: boolean\n\t\texpress: boolean\n\t\tregional: boolean\n\t}\n}\n\nexport const getDelay = (\n\tdelay: number | null | undefined,\n\tcancelled: boolean | null | undefined\n) => {\n\tif (delay != null) {\n\t\tconst valueRaw = Math.abs(delay / 60)\n\t\tconst value = Math.round(valueRaw)\n\t\treturn value\n\t\t// return `${sign}${value}`\n\t} else if (cancelled) {\n\t\treturn \"X\"\n\t} else {\n\t\treturn \"?\"\n\t}\n}\n\nexport const getPlanTime = (realtime: string, delay: number, sign: string) => {\n\tlet hours = Number(realtime.substring(0, 2))\n\tlet minutes = Number(realtime.substring(3, 5))\n\tminutes = sign === \"+\" ? minutes - delay : sign === \"–\" ? minutes + delay : minutes\n\tif (minutes < 0) {\n\t\tminutes += 60\n\t\thours -= 1\n\t}\n\tif (minutes > 59) {\n\t\tminutes -= 60\n\t\thours += 1\n\t}\n\tif (hours < 0) {\n\t\thours += 24\n\t}\n\tif (hours > 23) {\n\t\thours -= 24\n\t}\n\tlet hourString = hours < 10 ? `0${hours}` : `${hours}`\n\tlet minuteString = minutes < 10 ? `0${minutes}` : `${minutes}`\n\treturn `${hourString}:${minuteString}`\n}\n\nexport const getTime = (timestamp: string | undefined | null) => {\n\tif (timestamp != null) {\n\t\treturn timestamp.substring(11, 16)\n\t} else {\n\t\treturn \"\"\n\t}\n}\n\nconst Arrival = (props: Props) => {\n\tconst [currPosition, setCurrPosition] = useState(null)\n\tconst [trip, setTrip] = useState(undefined)\n\tconst [distance, setDistance] = useState<number|null>(null)\n\tuseEffect(() => {\n\t\tconst getDistance = () => {\n\tconst pi = 4 * Math.atan(1)\n\tconst { currentTripPosition, stop, line } = props.arr\n\tif (currentTripPosition) {\n\t\tconst { latitude: currLat, longitude: currLng } = currentTripPosition\n\t\tfetch(`https://vbb-rest.vercel.app/locations/nearby?latitude=${currLat}&longitude=${currLng}&results=10&language=de`)\n\t\t.then(response => response.json())\n\t\t.then(data => data.filter((singleStop: SingleStop) => singleStop.products[line.product] === true))\n\t\t.then(stops => {\n\t\t\tif (stops.length > 0 && stops[0].name) {\n\t\t\t\tsetCurrPosition(stops[0].name)\n\t\t\t}\n\t\t})\n\t\t.catch(error => console.debug(error))\n\t\tconst { location } = stop\n\t\tconst { latitude: stopLat, longitude: stopLng } = location\n\t\tconst rCurrLat = (pi * currLat) / 180\n\t\tconst rStopLat = (pi * stopLat) / 180\n\t\tconst theta = currLng - stopLng\n\t\tconst rTheta = (pi * theta) / 180\n\t\tconst cosDist =\n\t\t\tMath.sin(rCurrLat) * Math.sin(rStopLat) +\n\t\t\tMath.cos(rCurrLat) * Math.cos(rStopLat) * Math.cos(rTheta)\n\t\tconst radDist = Math.acos(cosDist)\n\t\tconst degDist = (radDist * 180) / pi\n\t\tconst dist = degDist * 60 * 1.1515\n\t\tsetDistance(dist)\n\t}\n}\ngetDistance()\n\t},[])\n\tuseEffect(() => {\n\t\tfetch(`https://vbb-rest.vercel.app/trips/${props.arr.tripId}?language=de`)\n\t\t.then(response => response.json())\n\t\t.then(data => setTrip(data.trip))\n\t\t.catch(error => console.debug(error))\n\t},[])\n\tconst delayMin = props.arr.cancelled ? getDelay(props.arr.delay, props.arr.cancelled) : getDelay(props.arr.delay, false)\n\tlet delay\n\tlet sign\n\tif (typeof props.arr.delay === \"number\" && typeof delayMin === \"number\") {\n\t\tsign = props.arr.delay < 0 ? \"–\" : props.arr.delay > 0 ? \"+\" : \"±\"\n\t\tdelay = `${sign}${delayMin}`\n\t} else {\n\t\tdelay = delayMin\n\t\tsign = \"±\"\n\t}\n\tlet realtime = getTime(props.arr.when)\n\tlet plantime\n\tif (props.arr.when != null && props.arr.delay != null) {\n\t\tplantime = getPlanTime(realtime, Number(delayMin), sign)\n\t} else if (props.arr.when != null && delayMin === \"?\") {\n\t\tplantime = realtime\n\t\trealtime = \"\"\n\t} else {\n\t\tplantime =\n\t\t\tgetTime(props.arr.formerScheduledWhen) ||\n\t\t\tgetTime(props.arr.scheduledWhen) ||\n\t\t\tgetTime(props.arr.plannedWhen)\n\t}\n\tconst { line, provenance, remarks, platform } = props.arr\n\treturn (\n\t\t<Fragment>\n\t\t\t<div\n\t\t\t\tclassName=\"row\"\n\t\t\t\tkey={props.arr.tripId}\n\t\t\t\tsx={{ display: \"grid\", gridTemplateColumns: [\"repeat(24,1fr)\", \"repeat(24,1fr)\", \"repeat(26,1fr)\"] }}\n\t\t\t>\n\t\t\t\t<Time time={plantime} class=\"plantime\" />\n\t\t\t\t<Time time={realtime} class=\"realtime\" />\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"delay\"\n\t\t\t\t\tsx={{\n\t\t\t\t\t\ttextAlign: [\"center\", \"center\", \"right\"],\n\t\t\t\t\t\tgridColumn: [\"17 / span 8\", \"5 / span 2\"],\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{delay}\n\t\t\t\t</div>\n\t\t\t\t<Product line={line} />\n\t\t\t\t<Line line={line} />\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"direction\"\n\t\t\t\t\tsx={{ textAlign: \"left\", gridColumn: [\"8 / span 13\", \"11 / span 8\"] }}\n\t\t\t\t>\n\t\t\t\t\t{provenance}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"platform\"\n\t\t\t\t\tsx={{\n\t\t\t\t\t\ttextAlign: \"center\",\n\t\t\t\t\t\tgridColumn: [\"22 / span 3\", \"19 / span 2\"],\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{platform}\n\t\t\t\t</div>\n\t\t\t\t<Barrier remarks={remarks} />\n\t\t\t\t<Bike remarks={remarks} />\n\t\t\t\t<Warning remarks={remarks} />\n\t\t\t\t<Status remarks={remarks} />\n\t\t\t\t{line.operator ? <Carrier operator={line.operator} /> : <div></div>}\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclassName=\"row row-add\"\n\t\t\t\tkey={`add:${props.arr.tripId}`}\n\t\t\t\tsx={{\n\t\t\t\t\tdisplay: \"grid\",\n\t\t\t\t\tgridTemplateColumns: \"repeat(24, 1fr)\",\n\t\t\t\t\tborderBottom: [\"1px solid #ccc\", \"1px solid #ccc\", \"none\"],\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{currPosition && distance && <Distance position={currPosition} distance={distance} />}\n\t\t\t\t{trip && <Trip trip={trip} stopId={props.arr.stop.id} mode=\"arr\" />}\n\t\t\t\t<Warntext remarks={remarks} />\n\t\t\t\t<Stattext remarks={remarks} />\n\t\t\t</div>\n\t\t</Fragment>\n\t)\n}\n\nexport default Arrival\n","/** @jsxImportSource theme-ui */\n\ntype Props = {\n\tposition: string\n\tdistance: number\n}\n\nexport function Distance({ position, distance }: Props) {\n\tif (position && distance) {\n\t\treturn (\n\t\t\t<div sx={{ gridColumn: \"1 / 25\" }}>\n\t\t\t\t{navigator.language.startsWith(\"de\") ? \"Aktuelle Position: \" : \"Current Position: \"}\n\t\t\t\t<span>{position}</span>{\" \"}\n\t\t\t\t({distance.toFixed(3)} km)\n\t\t\t</div>\n\t\t)\n\t}\n\treturn (<div></div>)\n}\n"],"names":["Carrier","lazy","Trip","Time","Product","Line","Barrier","Bike","Warning","Status","Warntext","Stattext","getDelay","delay","cancelled","valueRaw","Math","abs","round","getPlanTime","realtime","sign","hours","Number","substring","minutes","hourString","concat","minuteString","getTime","timestamp","props","_useState","useState","_useState2","_slicedToArray","currPosition","setCurrPosition","_useState3","undefined","_useState4","trip","setTrip","_useState5","_useState6","distance","setDistance","useEffect","pi","atan","_props$arr","arr","currentTripPosition","stop","line","currLat","latitude","currLng","longitude","fetch","then","response","json","data","filter","singleStop","products","product","stops","length","name","catch","error","console","debug","location","rCurrLat","rStopLat","rTheta","cosDist","sin","cos","radDist","acos","getDistance","tripId","delayMin","plantime","when","formerScheduledWhen","scheduledWhen","plannedWhen","_props$arr2","provenance","remarks","platform","_jsxs","Fragment","children","className","sx","display","gridTemplateColumns","_jsx","time","class","textAlign","gridColumn","operator","borderBottom","Distance","position","stopId","id","mode","_ref","navigator","language","startsWith","toFixed"],"sourceRoot":""}