"use strict";(self.webpackChunkvbb=self.webpackChunkvbb||[]).push([[388],{2388:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Y,getDelay:()=>f,getPlanTime:()=>y,getTime:()=>v});var a=n(5043),l=n(8408),d=n(7483);const r=(0,a.lazy)((()=>n.e(468).then(n.bind(n,4690)))),s=(0,a.lazy)((()=>n.e(824).then(n.bind(n,8824)))),i=(0,a.lazy)((()=>n.e(260).then(n.bind(n,5260)))),o=(0,a.lazy)((()=>n.e(214).then(n.bind(n,9214)))),c=(0,a.lazy)((()=>Promise.resolve().then(n.bind(n,9434)))),p=(0,a.lazy)((()=>n.e(336).then(n.bind(n,3336)))),u=(0,a.lazy)((()=>n.e(740).then(n.bind(n,3740)))),h=(0,a.lazy)((()=>n.e(500).then(n.bind(n,3500)))),m=(0,a.lazy)((()=>n.e(966).then(n.bind(n,7966)))),b=(0,a.lazy)((()=>n.e(976).then(n.bind(n,1976)))),g=(0,a.lazy)((()=>n.e(392).then(n.bind(n,2392)))),f=(e,t)=>{if(null!=e){const t=Math.abs(e/60);return Math.round(t)}return t?"X":"?"},y=(e,t,n)=>{let a=Number(e.substring(0,2)),l=Number(e.substring(3,5));l="+"===n?l-t:"\u2013"===n?l+t:l,l<0&&(l+=60,a-=1),l>59&&(l-=60,a+=1),a<0&&(a+=24),a>23&&(a-=24);let d=a<10?"0".concat(a):"".concat(a),r=l<10?"0".concat(l):"".concat(l);return"".concat(d,":").concat(r)},v=e=>null!=e?e.substring(11,16):"",Y=e=>{const[t,n]=(0,a.useState)(null),[Y,k]=(0,a.useState)(void 0),[x,z]=(0,a.useState)(null);(0,a.useEffect)((()=>{(()=>{const t=4*Math.atan(1),{currentTripPosition:a,stop:l}=e.dep;if(a){const{latitude:e,longitude:d}=a;fetch("https://vbb-rest.vercel.app/locations/nearby?latitude=".concat(e,"&longitude=").concat(d,"&results=1&language=de")).then((e=>e.json())).then((e=>{e.length>0&&e[0].name&&n(e[0])})).catch((e=>console.debug(e)));const{location:r}=l,{latitude:s,longitude:i}=r,o=t*e/180,c=t*s/180,p=t*(d-i)/180,u=Math.sin(o)*Math.sin(c)+Math.cos(o)*Math.cos(c)*Math.cos(p),h=Math.acos(u);z(60*(180*h/t)*1.1515)}})()}),[]),(0,a.useEffect)((()=>{fetch("https://vbb-rest.vercel.app/trips/".concat(e.dep.tripId,"?language=de")).then((e=>e.json())).then((e=>k(e.trip))).catch((e=>console.debug(e)))}),[]);const C=e.dep.cancelled?f(e.dep.delay,e.dep.cancelled):f(e.dep.delay,!1);let M,w;"number"===typeof e.dep.delay&&"number"===typeof C?(w=e.dep.delay<0?"\u2013":e.dep.delay>0?"+":"\xb1",M="".concat(w).concat(C)):(M=C,w="\xb1");let N,P=v(e.dep.when);null!=e.dep.when&&null!=e.dep.delay?N=y(P,Number(C),w):null!=e.dep.when&&"?"===C?(N=P,P=""):N=v(e.dep.formerScheduledWhen)||v(e.dep.scheduledWhen)||v(e.dep.plannedWhen);const{line:F,direction:D,remarks:T,platform:A,plannedPlatform:I,prognosedPlatform:S}=e.dep;return(0,d.FD)(a.Fragment,{children:[(0,d.FD)("div",{className:"row",sx:{display:"grid",gridTemplateColumns:["repeat(24,1fr)","repeat(24,1fr)","repeat(26,1fr)"]},children:[(0,d.Y)(i,{time:N,class:"plantime"}),(0,d.Y)(i,{time:P,class:"realtime"}),(0,d.Y)("div",{className:"delay",sx:{textAlign:["center","center","right"],gridColumn:["17 / span 8","5 / span 2"]},children:M}),(0,d.Y)(o,{line:F}),(0,d.Y)(c,{line:F}),(0,d.Y)("div",{className:"direction",sx:{textAlign:"left",gridColumn:["8 / span 13","11 / span 8"]},children:D}),(0,d.Y)("div",{className:"platform",sx:{textAlign:"center",gridColumn:["22 / span 3","19 / span 2"]},children:A||I||S}),(0,d.Y)(p,{remarks:T}),(0,d.Y)(u,{remarks:T}),(0,d.Y)(h,{remarks:T}),(0,d.Y)(m,{remarks:T}),F.operator?(0,d.Y)(r,{operator:F.operator}):(0,d.Y)("div",{})]},e.dep.tripId),(0,d.FD)("div",{className:"row row-add",sx:{display:"grid",gridTemplateColumns:"repeat(24, 1fr)",borderBottom:["1px solid #ccc","1px solid #ccc","none"]},children:[t&&x&&(0,d.Y)(l.K,{position:t,distance:x}),Y&&(0,d.Y)(s,{trip:Y,stopId:e.dep.stop.id,mode:"dep"}),(0,d.Y)(b,{remarks:T}),(0,d.Y)(g,{remarks:T})]},"add:".concat(e.dep.tripId))]})}},8408:(e,t,n)=>{n.d(t,{K:()=>l});var a=n(7483);function l(e){let{position:t,distance:n}=e;return t&&n?(0,a.FD)("div",{sx:{gridColumn:"1 / 25"},children:[navigator.language.startsWith("de")?"Aktuelle Position: ":"Current Position: ",(0,a.Y)("span",{children:t.name})," ","(",n.toFixed(3)," km)"]}):(0,a.Y)("div",{})}}}]);
//# sourceMappingURL=388.dca309c4.chunk.js.map