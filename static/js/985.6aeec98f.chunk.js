"use strict";(self.webpackChunkvbb=self.webpackChunkvbb||[]).push([[985],{2985:function(e,t,n){n.r(t),n.d(t,{default:function(){return m}});var r=n(3433),a=n(4165),c=n(5861),i=n(9439),u=n(2791),o=n(7689),s=n(5918),l=n(1243),f=n(2530),d=n(184),v=(0,u.lazy)((function(){return n.e(307).then(n.bind(n,4307))})),p=(0,u.lazy)((function(){return n.e(313).then(n.bind(n,6313))})),h=(0,u.lazy)((function(){return n.e(90).then(n.bind(n,3090))})),g=(0,u.lazy)((function(){return n.e(953).then(n.bind(n,953))})),b=(0,u.lazy)((function(){return n.e(29).then(n.bind(n,1029))}));function m(){var e=(0,s.Rh)("selection",[]),t=(0,i.Z)(e,2),n=t[0],m=t[1],x=(0,s.Rh)("stop",{id:"",name:"",type:""}),y=(0,i.Z)(x,2),w=y[0],k=y[1],Z=(0,s.Rh)("data",[]),j=(0,i.Z)(Z,2),L=j[0],R=j[1],B=(0,s.Rh)("date",""),C=(0,i.Z)(B,2),I=C[0],S=C[1],A=(0,s.Rh)("viewData",[]),D=(0,i.Z)(A,2),O=D[0],N=D[1],H=(0,s.Rh)("error",null),z=(0,i.Z)(H,2),E=z[0],P=z[1],W=(0,o.UO)(),F=(0,o.s0)();(0,u.useEffect)((function(){function e(){return(e=(0,c.Z)((0,a.Z)().mark((function e(){var t,n,r,c,i,u,o,s,l,f,d,v,p,h;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!W.hasOwnProperty("id")||"string"!==typeof W.id||9!==W.id.length){e.next=25;break}return e.prev=1,e.next=4,fetch("https://station-api-jade.vercel.app/?id=".concat(W.id));case 4:return t=e.sent,e.next=7,t.json();case 7:return n=e.sent,e.next=10,n;case 10:r=e.sent,c=r.name,F("/arrivals/".concat(W.id)),k(n),Q(W.id,c),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(c):"Arrivals at ".concat(c),m([n]),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),console.debug(e.t0);case 23:e.next=74;break;case 25:if(!W.hasOwnProperty("id")||"string"!==typeof W.id||12!==W.id.length){e.next=51;break}return e.prev=26,i="".concat(W.id.slice(0,1)).concat(W.id.slice(-8)),e.next=30,fetch("https://station-api-jade.vercel.app/?id=".concat(i));case 30:return u=e.sent,e.next=33,u.json();case 33:return o=e.sent,e.next=36,o;case 36:s=e.sent,l=s.name,F("/arrivals/".concat(i)),k(o),Q(i,l),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(l):"Arrivals at ".concat(l),m([o]),e.next=49;break;case 46:e.prev=46,e.t1=e.catch(26),console.debug(e.t1);case 49:e.next=74;break;case 51:return e.prev=51,f="900100011",e.next=55,fetch("https://station-api-jade.vercel.app/?id=".concat(f));case 55:return d=e.sent,e.next=58,d.json();case 58:return v=e.sent,e.next=61,v;case 61:p=e.sent,h=p.name,F("/arrivals/".concat(f)),k(v),Q(f,h),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(h):"Arrivals at ".concat(h),m([v]),e.next=74;break;case 71:e.prev=71,e.t2=e.catch(51),console.debug(e.t2);case 74:case"end":return e.stop()}}),e,null,[[1,20],[26,46],[51,71]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),setInterval((function(){return Q(w.id,w.name)}),12e4)}),[]);var G=(0,u.useRef)(null),T=(0,u.useRef)(null),M=(0,u.useRef)(null),U=function(e){var t=L.filter((function(t){var n=!1;if(t.hasOwnProperty("provenance")&&t.provenance)for(var r=0;r<e.length;r++)if(t.line.name.toLowerCase().includes(e[r].toLowerCase())||t.provenance.toLowerCase().includes(e[r].toLowerCase())){n=!0;break}return n}));N(t)},q=function(e){var t=L.filter((function(t){var n=!0;if(t.hasOwnProperty("provenance")&&t.provenance)for(var r=0;r<e.length;r++)if(!t.line.name.toLowerCase().includes(e[r].toLowerCase())&&!t.provenance.toLowerCase().includes(e[r].toLowerCase())){n=!1;break}return n}));N(t)},J=function(){N(L)},K=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t){var n,c,i,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.value,e.prev=1,!(n.length>4)){e.next=13;break}return e.next=5,fetch("https://station-api-jade.vercel.app/?station=".concat(n));case 5:return c=e.sent,e.next=8,c.json();case 8:i=e.sent,u=[w].concat((0,r.Z)(i)),m(u),e.next=14;break;case 13:m([w]);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.debug(e.t0);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=(0,c.Z)((0,a.Z)().mark((function e(t,n){var r,c,i,u,o,s,d,v,p,h,g;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=n.startsWith("Berlin")?"BLN":"BBG",c=(0,f.g)(r),i="de",u=navigator.language,i=u.startsWith("de")?"de":"en",o="https://vbb-rest.vercel.app/stops/".concat(t,"/arrivals?language=").concat(i,"&duration=").concat(c),e.next=9,l.Z.get(o);case 9:return s=e.sent,e.next=12,s;case 12:d=e.sent,v=d.data,500===(p=d.status)||200!==p?(P("HTTP status code: ".concat(p)),R([])):(h=(new Date).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}),g=v.arrivals,document.title="de"===i?"Ank\xfcnfte an ".concat(n):"Arrivals at ".concat(n),S(h),R(g),N(g),P(null)),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.debug(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}();return(0,d.jsxs)("div",{className:"timetable",children:[(0,d.jsx)(v,{filterStops:K,inputField:G}),(0,d.jsx)(p,{handleChange:function(e){k(e);var t=e.id,n=e.name;Q(t,n),G.current.value="",T.current.value="",M.current.value="OR"},selection:n,stop:w,mode:"arr"}),(0,d.jsx)(h,{handleSubmit:function(){Q(w.id,w.name),G.current.value="",T.current.value="",M.current.value="OR"}}),(0,d.jsx)(g,{filterField:T,filterSelector:M,filterData:function(){var e=T.current.value.split(" "),t=M.current.value;e.length>0?"OR"===t?U(e):q(e):J()},mode:"arr"}),(0,d.jsx)(b,{stop:w,data:O,error:E,date:I,mode:"arr"})]})}},2530:function(e,t,n){function r(e){switch(e){case"BLN":return function(){var e=o(),t=e.isItHoliday,n=e.isItSaturday,r=e.hour,a=60;a=t?r<7||r<8?60:r<20?40:60:n?r<6?60:r<7?40:r<21?30:r<23?40:60:r<5?60:r<7?30:r<20?20:r<22?30:60;return a}();case"BHF":return function(){var e=o(),t=e.isItHoliday,n=e.isItSaturday,r=e.hour,a=60;a=t||n?r<5?60:r<6?30:r<7?20:r<22?10:r<23?20:30:r<5?30:r<6?20:r<7?10:r<22?5:r<23?10:20;return a}();case"BBG":return function(){var e=o(),t=e.isItHoliday,n=e.isItSaturday,r=e.hour,a=60;a=t||n?r<5?240:r<6||r<7||r<22||r<23?120:240:r<5?120:r<6||r<7||r<22||r<23?60:120;return a}()}}n.d(t,{g:function(){return r}});var a=function(e){return 0===e},c=function(e,t,n){if(1===e&&1===t)return!0;if(8===e&&3===t)return!0;if(1===e&&5===t)return!0;if(3===e&&10===t)return!0;if(12===t&&(25===e||26===e))return!0;var r=!1;return u(n).forEach((function(n){e===n[0]&&t===n[1]&&(r=!0)})),!!r};var i=function(e){return 0!==e?Math.floor(e):0};var u=function(e){var t=e%19,n=i(e/100),r=i(n/4),a=(n-r-i((8*n+13)/25)+19*t+15)%30,c=a-i(a/20)*(1-i(29/(a+1))*i((21-t)/11)),u=c-(e+i(e/4)+c+2-n+r)%7,o=u<=3?3:4,s=u<=3?u+28:u-3,l=[];return[s<3&&4===o?[s+29,3,e]:[s-2,o,e],31===s&&3===o?[1,4,e]:[s+1,o,e],l=s<23&&3===o?[s+8,4,e]:3===o?[s-22,5,e]:s>21&&4===o?[s-22,6,e]:[s+9,5,e],4===l[1]?[l[0]-18,5,e]:l[0]>20&&5===l[1]?[l[0]-19,6,e]:[l[0]+11,l[1],e]]};function o(){var e=(new Date).toLocaleDateString("en-GB",{timeZone:"Europe/Berlin",year:"numeric",month:"numeric",day:"numeric",hour:"numeric"}).split(","),t=e[0].split("/"),n=Number(e[1]),r=Number(t[0]),i=Number(t[1]),u=Number(t[2]),o=new Date(u,i-1,r).getDay(),s=a(o)||c(r,i,u),l=function(e){return 6===e}(o);return{isItHoliday:s,isItSaturday:l,hour:n}}}}]);
//# sourceMappingURL=985.6aeec98f.chunk.js.map