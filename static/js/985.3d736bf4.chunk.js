"use strict";(self.webpackChunkvbb=self.webpackChunkvbb||[]).push([[985],{2985:(t,e,i)=>{i.r(e),i.d(e,{default:()=>f});var n=i(2791),a=i(7689),o=i(1087),r=i(5918),c=i(2530),s=i(4307),d=i(6313),l=i(3090),u=i(953),g=i(1036),p=i(1029),h=i(4994),m=i(9922);function f(){const[t,e]=(0,r.Rh)("selection",[]),[i,f]=(0,r.Rh)("filterSelection",[]),[y,b]=(0,r.Rh)("stop",{id:"",name:"",type:""}),[v,w]=(0,r.Rh)("filterStop",{id:"0",name:"\u2e3a",type:""}),[S,Z]=(0,r.Rh)("data",[]),[R,B]=(0,r.Rh)("date",""),[D,E]=(0,r.Rh)("error",null),[k,A]=(0,r.Rh)("express",!0),[L,j]=(0,r.Rh)("regional",!0),[O,T]=(0,r.Rh)("suburban",!0),[W,x]=(0,r.Rh)("subway",!0),[z,C]=(0,r.Rh)("tram",!0),[I,P]=(0,r.Rh)("bus",!0),[q,F]=(0,r.Rh)("ferry",!0),[N,X]=(0,r.Rh)("time",(new Date).toLocaleString("sv",{timeZone:"Europe/Berlin",minute:"2-digit",hour:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}).replace(" ","T")),G=(0,a.UO)(),[H,U]=(0,o.useSearchParams)(),J=(0,a.s0)();(0,n.useEffect)((()=>{!async function(){if(G.hasOwnProperty("id")&&"string"===typeof G.id&&9===G.id.length)try{const t="https://vbb-rest.vercel.app/stops/".concat(G.id,"?language=de"),i=await fetch(t),n=await i.json(),{name:a}=await n;J("/arrivals/".concat(G.id)),b(n);const o=H.has("direction")&&H.get("direction")?H.get("direction"):"0";if("string"===typeof o&&"0"!==o){const t="https://vbb-rest.vercel.app/stops/".concat(o,"?language=de"),e=await fetch(t),i=await e.json(),{name:n}=await i;w({id:o,name:n,type:""})}else w({id:"0",name:"\u2e3a",type:""});Q(G.id,a,{direction:o}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(a):"Arrivals at ".concat(a);e([n])}catch(D){console.debug(D)}else if(G.hasOwnProperty("id")&&"string"===typeof G.id&&12===G.id.length)try{const t="".concat(G.id.slice(0,1)).concat(G.id.slice(-8)),i="https://vbb-rest.vercel.app/stops/".concat(t,"?language=de"),n=await fetch(i),a=await n.json(),{name:o}=await a;J("/arrivals/".concat(t)),b(a),Q(t,o,{direction:"0"}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(o):"Arrivals at ".concat(o);e([a])}catch(D){console.debug(D)}else try{const t="900100011",i="https://vbb-rest.vercel.app/stops/".concat(t,"?language=de"),n=await fetch(i),a=await n.json(),{name:o}=await a;J("/arrivals/".concat(t)),b(a),Q(t,o,{direction:"0"}),document.title=navigator.language.startsWith("de")?"Ank\xfcnfte an ".concat(o):"Arrivals at ".concat(o);e([a])}catch(D){console.debug(D)}}()}),[]);const K=(0,n.useRef)(null),M=(0,n.useRef)(null),Q=async(t,e,i)=>{try{const n=e.startsWith("Berlin")?"BLN":"BBG",a=(0,c.g)(n);let o="de";o=navigator.language.startsWith("de")?"de":"en";const r=i.direction?"0"!==i.direction?parseInt(i.direction,10):null:"0"!==v.id?parseInt(v.id,10):null,s="number"===typeof r?"&direction=".concat(r):"";if((t===y.id||""===R)&&!i.time){const t=(new Date).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}),e=(new Date).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T");B(t),X(e)}const d="https://vbb-rest.vercel.app/stops/".concat(t,"/arrivals?language=").concat(o,"&duration=").concat(a,"&express=").concat("boolean"===typeof i.express?i.express.toString():k.toString(),"&regional=").concat("boolean"===typeof i.regional?i.regional.toString():L.toString(),"&suburban=").concat("boolean"===typeof i.suburban?i.suburban.toString():O.toString(),"&subway=").concat("boolean"===typeof i.subway?i.subway.toString():W.toString(),"&tram=").concat("boolean"===typeof i.tram?i.tram.toString():z.toString(),"&bus=").concat("boolean"===typeof i.bus?i.bus.toString():I.toString(),"&ferry=").concat("boolean"===typeof i.ferry?i.ferry.toString():q.toString()).concat(s,"&when=").concat("string"===typeof i.time?new Date(i.time).toISOString():new Date(N).toISOString()),l=await fetch(d),{status:u}=await l,g=await l.json();if(500===u||200!==u)E("HTTP status code: ".concat(u)),Z([]);else{const{arrivals:t}=g;document.title="de"===o?"Ank\xfcnfte an ".concat(e):"Arrivals at ".concat(e),Z(t),E(null)}}catch(D){console.debug(D)}};return(0,m.BX)("div",{className:"timetable",children:[(0,m.tZ)(s.Z,{filterStops:async t=>{const i=t.target.value;try{if(i.length>4){const t="https://vbb-rest.vercel.app/locations?query=".concat(i,"&results=15&fuzzy=true&stops=true&addresses=false&poi=false&language=de&linesOfStops=true"),n=await fetch(t),a=await n.json(),o=[y,...a];e(o)}else e([y])}catch(D){console.debug(D)}},inputField:K}),(0,m.tZ)(d.Z,{handleChange:t=>{b(t);const{id:e,name:i}=t;Q(e,i,{direction:"0"});K.current.value=""},selection:t,stop:y,mode:"arr"}),(0,m.tZ)(l.Z,{handleSubmit:()=>{const t=(new Date).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}),e=(new Date).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T");B(t),X(e),Q(y.id,y.name,{direction:v.id,time:e});K.current.value=""}}),(0,m.BX)("div",{children:[(0,m.tZ)("span",{sx:{display:"inline-block",mr:"0.2rem",fontStyle:"italic",fontWeight:700},children:"via"}),(0,m.tZ)(s.Z,{filterStops:async t=>{const e=t.target.value;try{const t={id:"0",name:"\u2e3a",type:""};if(e.length>=3){const i="https://vbb-rest.vercel.app/locations?query=".concat(e,"&results=15&fuzzy=true&stops=true&addresses=false&poi=false&language=de&linesOfStops=true"),n=await fetch(i),a=await n.json(),o="0"!==v.id?[t,v,...a]:[t,...a];f(o)}else if("0"!==v.id){f([t,v])}else f([t])}catch(D){console.debug(D)}},inputField:M}),(0,m.tZ)(u.Z,{handleChange:t=>{"0"!==t.id?(w(t),U({direction:t.id}),Q(y.id,y.name,{direction:t.id})):(w({id:"0",name:"\u2e3a",type:""}),U({direction:"0"}),Q(y.id,y.name,{direction:"0"}));M.current.value=""},selection:i,stop:v})]}),(0,m.tZ)(g.Z,{products:[k,L,O,W,z,I,q],productSetters:[A,j,T,x,C,P,F],getData:t=>Q(y.id,y.name,t)}),(0,m.tZ)(h.Z,{time:N,setTime:t=>{const e=new Date(t).toLocaleString("sv",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"}).replace(" ","T"),i=new Date(t).toLocaleString("de-DE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Europe/Berlin"});X(e),B(i),Q(y.id,y.name,{direction:v.id,time:e})}}),(0,m.tZ)(p.Z,{stop:y,data:S,error:D,date:R,mode:"arr"})]})}}}]);
//# sourceMappingURL=985.3d736bf4.chunk.js.map