"use strict";(self.webpackChunkvbb=self.webpackChunkvbb||[]).push([[522],{7522:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Z,getDelay:()=>y,getPlanTime:()=>f,getTime:()=>v});var a=r(2791),n=r(4373),l=r(9922);const s=(0,a.lazy)((()=>r.e(599).then(r.bind(r,8705)))),i=(0,a.lazy)((()=>r.e(305).then(r.bind(r,6305)))),c=(0,a.lazy)((()=>r.e(272).then(r.bind(r,5272)))),o=(0,a.lazy)((()=>r.e(833).then(r.bind(r,833)))),d=(0,a.lazy)((()=>Promise.resolve().then(r.bind(r,6049)))),u=(0,a.lazy)((()=>r.e(302).then(r.bind(r,6302)))),h=(0,a.lazy)((()=>r.e(734).then(r.bind(r,734)))),p=(0,a.lazy)((()=>r.e(619).then(r.bind(r,619)))),m=(0,a.lazy)((()=>r.e(776).then(r.bind(r,7776)))),b=(0,a.lazy)((()=>r.e(558).then(r.bind(r,4558)))),g=(0,a.lazy)((()=>r.e(525).then(r.bind(r,1525)))),y=(e,t)=>{if(null!=e){const t=Math.abs(e/60);return Math.round(t)}return t?"X":"?"},f=(e,t,r)=>{let a=Number(e.substring(0,2)),n=Number(e.substring(3,5));n="+"===r?n-t:"\u2013"===r?n+t:n,n<0&&(n+=60,a-=1),n>59&&(n-=60,a+=1),a<0&&(a+=24),a>23&&(a-=24);let l=a<10?"0".concat(a):"".concat(a),s=n<10?"0".concat(n):"".concat(n);return"".concat(l,":").concat(s)},v=e=>null!=e?e.substring(11,16):"",Z=e=>{const[t,r]=(0,a.useState)(null),[Z,k]=(0,a.useState)(void 0),[x,z]=(0,a.useState)(null);(0,a.useEffect)((()=>{(()=>{const t=4*Math.atan(1),{currentTripPosition:a,stop:n}=e.arr;if(a){const{latitude:e,longitude:l}=a;fetch("https://vbb-rest.vercel.app/locations/nearby?latitude=".concat(e,"&longitude=").concat(l,"&results=1&language=de")).then((e=>e.json())).then((e=>{e.length>0&&e[0].name&&r(e[0])})).catch((e=>console.debug(e)));const{location:s}=n,{latitude:i,longitude:c}=s,o=t*e/180,d=t*i/180,u=t*(l-c)/180,h=Math.sin(o)*Math.sin(d)+Math.cos(o)*Math.cos(d)*Math.cos(u),p=Math.acos(h);z(60*(180*p/t)*1.1515)}})()}),[]),(0,a.useEffect)((()=>{fetch("https://vbb-rest.vercel.app/trips/".concat(e.arr.tripId,"?language=de")).then((e=>e.json())).then((e=>k(e.trip))).catch((e=>console.debug(e)))}),[]);const C=e.arr.cancelled?y(e.arr.delay,e.arr.cancelled):y(e.arr.delay,!1);let M,w;"number"===typeof e.arr.delay&&"number"===typeof C?(w=e.arr.delay<0?"\u2013":e.arr.delay>0?"+":"\xb1",M="".concat(w).concat(C)):(M=C,w="\xb1");let N,B=v(e.arr.when);null!=e.arr.when&&null!=e.arr.delay?N=f(B,Number(C),w):null!=e.arr.when&&"?"===C?(N=B,B=""):N=v(e.arr.formerScheduledWhen)||v(e.arr.scheduledWhen)||v(e.arr.plannedWhen);const{line:P,provenance:T,remarks:X,platform:A}=e.arr;return(0,l.BX)(a.Fragment,{children:[(0,l.BX)("div",{className:"row",sx:{display:"grid",gridTemplateColumns:["repeat(24,1fr)","repeat(24,1fr)","repeat(26,1fr)"]},children:[(0,l.tZ)(c,{time:N,class:"plantime"}),(0,l.tZ)(c,{time:B,class:"realtime"}),(0,l.tZ)("div",{className:"delay",sx:{textAlign:["center","center","right"],gridColumn:["17 / span 8","5 / span 2"]},children:M}),(0,l.tZ)(o,{line:P}),(0,l.tZ)(d,{line:P}),(0,l.tZ)("div",{className:"direction",sx:{textAlign:"left",gridColumn:["8 / span 13","11 / span 8"]},children:T}),(0,l.tZ)("div",{className:"platform",sx:{textAlign:"center",gridColumn:["22 / span 3","19 / span 2"]},children:A}),(0,l.tZ)(u,{remarks:X}),(0,l.tZ)(h,{remarks:X}),(0,l.tZ)(p,{remarks:X}),(0,l.tZ)(m,{remarks:X}),P.operator?(0,l.tZ)(s,{operator:P.operator}):(0,l.tZ)("div",{})]},e.arr.tripId),(0,l.BX)("div",{className:"row row-add",sx:{display:"grid",gridTemplateColumns:"repeat(24, 1fr)",borderBottom:["1px solid #ccc","1px solid #ccc","none"]},children:[t&&x&&(0,l.tZ)(n.r,{position:t,distance:x}),Z&&(0,l.tZ)(i,{trip:Z,stopId:e.arr.stop.id,mode:"arr"}),(0,l.tZ)(b,{remarks:X}),(0,l.tZ)(g,{remarks:X})]},"add:".concat(e.arr.tripId))]})}},4373:(e,t,r)=>{r.d(t,{r:()=>n});var a=r(9922);function n(e){let{position:t,distance:r}=e;return t&&r?(0,a.BX)("div",{sx:{gridColumn:"1 / 25"},children:[navigator.language.startsWith("de")?"Aktuelle Position: ":"Current Position: ",(0,a.tZ)("span",{children:t.name})," ","(",r.toFixed(3)," km)"]}):(0,a.tZ)("div",{})}}}]);
//# sourceMappingURL=522.2940dec1.chunk.js.map