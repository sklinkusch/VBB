"use strict";(self.webpackChunkvbb=self.webpackChunkvbb||[]).push([[522],{7522:function(n,r,t){t.r(r),t.d(r,{getDelay:function(){return g},getPlanTime:function(){return y},getTime:function(){return Z}});var e=t(9439),a=t(2791),i=t(4373),c=t(9922),u=(0,a.lazy)((function(){return t.e(599).then(t.bind(t,8705))})),l=(0,a.lazy)((function(){return t.e(305).then(t.bind(t,6305))})),o=(0,a.lazy)((function(){return t.e(272).then(t.bind(t,5272))})),s=(0,a.lazy)((function(){return t.e(48).then(t.bind(t,1048))})),d=(0,a.lazy)((function(){return Promise.resolve().then(t.bind(t,6049))})),f=(0,a.lazy)((function(){return t.e(302).then(t.bind(t,6302))})),h=(0,a.lazy)((function(){return t.e(734).then(t.bind(t,734))})),p=(0,a.lazy)((function(){return t.e(619).then(t.bind(t,619))})),m=(0,a.lazy)((function(){return t.e(776).then(t.bind(t,7776))})),b=(0,a.lazy)((function(){return t.e(558).then(t.bind(t,4558))})),v=(0,a.lazy)((function(){return t.e(525).then(t.bind(t,1525))})),g=function(n,r){if(null!=n){var t=Math.abs(n/60);return Math.round(t)}return r?"X":"?"},y=function(n,r){var t=Number(n.substring(0,2)),e=Number(n.substring(3,5));(e-=r)<0&&(e+=60,t-=1),e>59&&(e-=60,t+=1),t<0&&(t+=24),t>23&&(t-=24);var a=t<10?"0".concat(t):"".concat(t),i=e<10?"0".concat(e):"".concat(e);return"".concat(a,":").concat(i)},Z=function(n){return null!=n?n.substring(11,16):""};r.default=function(n){var r=(0,a.useState)(null),t=(0,e.Z)(r,2),k=t[0],x=t[1],z=(0,a.useState)(void 0),C=(0,e.Z)(z,2),M=C[0],w=C[1],N=function(n){var r=4*Math.atan(1),t=n.currentTripPosition,e=n.stop;if(t){var a=t.latitude,i=t.longitude;fetch("https://vbb-rest.vercel.app/locations/nearby?latitude=".concat(a,"&longitude=").concat(i,"&results=10&language=de")).then((function(n){return n.json()})).then((function(r){return r.filter((function(r){return!0===r.products[n.line.product]}))})).then((function(n){n.length>0&&n[0].name&&x(n[0].name)}));var c=e.location,u=r*a/180,l=r*c.latitude/180,o=r*(i-c.longitude)/180,s=Math.sin(u)*Math.sin(l)+Math.cos(u)*Math.cos(l)*Math.cos(o);return 60*(180*Math.acos(s)/r)*1.1515}return null}(n.arr);(0,a.useEffect)((function(){fetch("https://vbb-rest.vercel.app/trips/".concat(n.arr.tripId,"?language=de")).then((function(n){return n.json()})).then((function(n){return w(n.trip)}))}),[]);var B,P=n.arr.cancelled?g(n.arr.delay,n.arr.cancelled):g(n.arr.delay,!1);if("number"===typeof n.arr.delay&&"number"===typeof P){var T=n.arr.delay<0?"\u2013":n.arr.delay>0?"+":"\xb1";B="".concat(T).concat(P)}else B=P;var X,A=Z(n.arr.when);null!=n.arr.when&&null!=n.arr.delay?X=y(A,Number(P)):null!=n.arr.when&&"?"===P?(X=A,A=""):X=Z(n.arr.formerScheduledWhen)||Z(n.arr.scheduledWhen)||Z(n.arr.plannedWhen);var I=n.arr,W=I.line,S=I.provenance,j=I.remarks,F=I.platform;return(0,c.BX)(a.Fragment,{children:[(0,c.BX)("div",{className:"row",sx:{display:"grid",gridTemplateColumns:["repeat(24,1fr)","repeat(24,1fr)","repeat(26,1fr)"]},children:[(0,c.tZ)(o,{time:X,class:"plantime"}),(0,c.tZ)(o,{time:A,class:"realtime"}),(0,c.tZ)("div",{className:"delay",sx:{textAlign:["center","center","right"],gridColumn:["17 / span 8","5 / span 2"]},children:B}),(0,c.tZ)(s,{line:W}),(0,c.tZ)(d,{line:W}),(0,c.tZ)("div",{className:"direction",sx:{textAlign:"left",gridColumn:["8 / span 13","11 / span 8"]},children:S}),(0,c.tZ)("div",{className:"platform",sx:{textAlign:"center",gridColumn:["22 / span 3","19 / span 2"]},children:F}),(0,c.tZ)(f,{remarks:j}),(0,c.tZ)(h,{remarks:j}),(0,c.tZ)(p,{remarks:j}),(0,c.tZ)(m,{remarks:j}),(0,c.tZ)(u,{operator:W.operator})]},n.arr.tripId),(0,c.BX)("div",{className:"row row-add",sx:{display:"grid",gridTemplateColumns:"repeat(24, 1fr)",borderBottom:["1px solid #ccc","1px solid #ccc","none"]},children:[k&&N&&(0,c.tZ)(i.r,{position:k,distance:N}),M&&(0,c.tZ)(l,{trip:M,stopId:n.arr.stop.id,mode:"arr"}),(0,c.tZ)(b,{remarks:j}),(0,c.tZ)(v,{remarks:j})]},"add:".concat(n.arr.tripId))]})}},4373:function(n,r,t){t.d(r,{r:function(){return a}});var e=t(9922);function a(n){var r=n.position,t=n.distance;return r&&t?(0,e.BX)("div",{sx:{gridColumn:"1 / 25"},children:[navigator.language.startsWith("de")?"Aktuelle Position: ":"Current Position: ",(0,e.tZ)("span",{children:r})," ","(",t.toFixed(3)," km)"]}):(0,e.tZ)("div",{})}}}]);
//# sourceMappingURL=522.240de5f5.chunk.js.map